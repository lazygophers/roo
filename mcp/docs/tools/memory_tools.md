# Memory Tools

`memory_tools` 模块提供了一系列用于管理和操作项目记忆库的工具。这些工具允许您在不同的层级（项目、根任务、子任务）上保存、搜索和检索记忆，从而实现信息的持久化和上下文感知。

## 工具一览

| 工具函数                | 描述                                 |
| ----------------------- | ------------------------------------ |
| `save_core_memory`      | 将信息作为“核心记忆”保存。           |
| `save_knowledge_memory` | 将信息作为“知识记忆”保存。           |
| `save_working_memory`   | 将信息作为“工作记忆”保存。           |
| `search_memory`         | 根据关键词在记忆库中进行搜索。       |
| `get_memory_by_id`      | 通过唯一的 ID 检索特定的记忆。       |
| `delete_memory_by_id`   | 通过唯一的 ID 删除特定的记忆。       |
| `get_memory_levels`     | 获取当前所有可用的记忆层级。         |
| `get_memory_namespaces` | 获取指定层级下的所有命名空间。       |
| `clear_memories`        | 清空指定层级和命名空间下的所有记忆。 |

---

## 保存工具

### `save_core_memory`

此工具用于将指定的文本内容保存为“核心记忆”。核心记忆通常用于存储与整个项目相关的、长期有效的信息，例如项目规范、核心架构决策或关键的背景知识。

**参数列表**

| 参数名      | 类型   | 描述                                                         |
| ----------- | ------ | ------------------------------------------------------------ |
| `content`   | `str`  | 需要保存的文本内容。                                         |
| `namespace` | `str`  | 记忆所属的命名空间，用于分类和组织记忆。默认为 `default`。   |
| `metadata`  | `dict` | （可选）一个附加的元数据字典，用于存储与记忆相关的额外信息。 |

**返回结果**

- `str`: 操作成功的确认信息，通常包含新创建记忆的唯一 ID。

**使用示例**

```python
save_core_memory(
  content="这是项目的核心设计理念...",
  namespace="architecture",
  metadata={"author": "doc-writer"}
)
```

### `save_knowledge_memory`

此工具用于将指定的文本内容保存为“知识记忆”。知识记忆与一个特定的顶层任务相关联，用于存储该任务的上下文、需求或关键执行步骤。

**参数列表**

| 参数名      | 类型   | 描述                                                         |
| ----------- | ------ | ------------------------------------------------------------ |
| `content`   | `str`  | 需要保存的文本内容。                                         |
| `namespace` | `str`  | 记忆所属的命名空间，用于分类和组织记忆。默认为 `default`。   |
| `metadata`  | `dict` | （可选）一个附加的元数据字典，用于存储与记忆相关的额外信息。 |

**返回结果**

- `str`: 操作成功的确认信息，通常包含新创建记忆的唯一 ID。

**使用示例**

```python
save_knowledge_memory(
  content="重构用户认证模块的详细步骤...",
  namespace="refactor-auth"
)
```

### `save_working_memory`

此工具用于将指定的文本内容保存为“工作记忆”。工作记忆与一个更具体的子任务相关联，用于存储执行该子任务时产生的临时数据、中间结果或特定上下文。

**参数列表**

| 参数名      | 类型   | 描述                                                         |
| ----------- | ------ | ------------------------------------------------------------ |
| `content`   | `str`  | 需要保存的文本内容。                                         |
| `namespace` | `str`  | 记忆所属的命名空间，用于分类和组织记忆。默认为 `default`。   |
| `metadata`  | `dict` | （可选）一个附加的元数据字典，用于存储与记忆相关的额外信息。 |

**返回结果**

- `str`: 操作成功的确认信息，通常包含新创建记忆的唯一 ID。

**使用示例**

```python
save_working_memory(
  content="用户密码加密函数的实现细节...",
  namespace="refactor-auth-crypto"
)
```

---

## 搜索工具

### `search_memory`

此工具用于在记忆库中执行关键词搜索，可以根据层级、命名空间和相似度阈值进行过滤。

**参数列表**

| 参数名           | 类型        | 描述                                                                                                                        |
| ---------------- | ----------- | --------------------------------------------------------------------------------------------------------------------------- |
| `query`          | `str`       | 用于搜索的关键词或问题。                                                                                                    |
| `levels`         | `List[str]` | （可选）一个包含记忆层级的列表，用于限定搜索范围。可选值为 `core`, `knowledge`, `working`。如果未提供，则在所有层级中搜索。 |
| `namespaces`     | `List[str]` | （可选）一个包含命名空间的列表，用于进一步过滤搜索结果。如果未提供，则在所有命名空间中搜索。                                |
| `limit`          | `int`       | （可选）返回的最大结果数量。默认为 `10`。                                                                                   |
| `min_similarity` | `float`     | （可选）结果的最小相似度得分，介于 0 和 1 之间。默认为 `0.8`。                                                              |

**返回结果**

- `str`: 一个 JSON 格式的字符串，其中包含了匹配的记忆列表。

**使用示例**

```python
# 在核心和知识层级中，搜索与“认证”相关的记忆
search_memory(
  query="关于用户认证的实现",
  levels=["core", "knowledge"],
  namespaces=["architecture", "refactor-auth"]
)
```
