import{d as x,r as i,i as V,c as n,a as e,t as d,j as y,v as h,k as D,g as $,F,l as B,o as l}from"./index-b1e20d89.js";import{a as p}from"./axios-b5ee139b.js";import{_ as M}from"./_plugin-vue_export-helper-c27b6911.js";const N={class:"items-view"},L={class:"page-header"},S={key:0,class:"form-card"},U={class:"form-group"},j={class:"form-group"},q={class:"form-actions"},z=["disabled"],A={class:"items-list"},E={key:0,class:"loading"},T={key:1,class:"error"},G={key:2,class:"empty-state"},H={key:3,class:"grid"},J={class:"item-meta"},K={class:"item-actions"},O=["onClick"],P=["onClick"],Q=x({__name:"ItemsView",setup(R){const c=i([]),_=i(!1),u=i(""),v=i(!1),m=i(!1),r=i(null),o=i({name:"",description:""}),f=async()=>{_.value=!0,u.value="";try{const s=await p.get("/api/items");c.value=s.data}catch(s){u.value="获取项目列表失败",console.error(s)}finally{_.value=!1}},g=async()=>{var s;v.value=!0;try{(s=r.value)!=null&&s.id?await p.put(`/api/items/${r.value.id}`,o.value):await p.post("/api/items",o.value),await f(),b()}catch(t){console.error("保存失败:",t),alert("保存失败，请重试")}finally{v.value=!1}},k=s=>{r.value={...s},o.value={...s},m.value=!1},w=async s=>{if(confirm("确定要删除这个项目吗？"))try{await p.delete(`/api/items/${s}`),await f()}catch(t){console.error("删除失败:",t),alert("删除失败，请重试")}},b=()=>{m.value=!1,r.value=null,o.value={name:"",description:""}},C=s=>s?new Date(s).toLocaleString("zh-CN"):"-";return V(()=>{f()}),(s,t)=>(l(),n("div",N,[e("div",L,[t[3]||(t[3]=e("h1",null,"项目管理",-1)),e("button",{onClick:t[0]||(t[0]=a=>m.value=!0),class:"btn btn-primary"},"添加新项目")]),m.value||r.value?(l(),n("div",S,[e("h2",null,d(r.value?"编辑项目":"添加新项目"),1),e("form",{onSubmit:D(g,["prevent"])},[e("div",U,[t[4]||(t[4]=e("label",{for:"name"},"名称",-1)),y(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.name=a),type:"text",required:"",placeholder:"输入项目名称"},null,512),[[h,o.value.name]])]),e("div",j,[t[5]||(t[5]=e("label",{for:"description"},"描述",-1)),y(e("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=a=>o.value.description=a),rows:"3",placeholder:"输入项目描述"},null,512),[[h,o.value.description]])]),e("div",q,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},d(v.value?"保存中...":"保存"),9,z),e("button",{type:"button",onClick:b,class:"btn btn-secondary"},"取消")])],32)])):$("",!0),e("div",A,[_.value&&c.value.length===0?(l(),n("div",E,"加载中...")):u.value?(l(),n("div",T,d(u.value),1)):c.value.length===0?(l(),n("div",G,[...t[6]||(t[6]=[e("p",null,'暂无项目，点击"添加新项目"创建第一个项目',-1)])])):(l(),n("div",H,[(l(!0),n(F,null,B(c.value,a=>(l(),n("div",{key:a.id,class:"item-card"},[e("h3",null,d(a.name),1),e("p",null,d(a.description||"暂无描述"),1),e("div",J,[e("small",null,"创建时间: "+d(C(a.created_at)),1)]),e("div",K,[e("button",{onClick:I=>k(a),class:"btn btn-sm"},"编辑",8,O),e("button",{onClick:I=>w(a.id),class:"btn btn-sm btn-danger"},"删除",8,P)])]))),128))]))])]))}});const Z=M(Q,[["__scopeId","data-v-01b16612"]]);export{Z as default};
