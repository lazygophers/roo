var Le=Object.defineProperty;var Ne=(d,l,r)=>l in d?Le(d,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[l]=r;var ve=(d,l,r)=>(Ne(d,typeof l!="symbol"?l+"":l,r),r);import{d as Se,r as C,f as be,g as Te,h as Ue,c as o,a as e,w as J,v as _e,b as ge,i as se,e as v,n as V,F as Y,j as G,k as we,l as De,T as Be,m as ae,t as u,o as n,p as me,q as Ve,s as Ke,u as K,x as Ae,y as xe,_ as Pe}from"./index-585cb5c2.js";import{_ as $e,a as ie}from"./_plugin-vue_export-helper-00450ef7.js";var Ye=typeof global=="object"&&global&&global.Object===Object&&global;const Ge=Ye;var He=typeof self=="object"&&self&&self.Object===Object&&self,ze=Ge||He||Function("return this")();const je=ze;var We=je.Symbol;const ye=We;var Me=Object.prototype,qe=Me.hasOwnProperty,Je=Me.toString,he=ye?ye.toStringTag:void 0;function Qe(d){var l=qe.call(d,he),r=d[he];try{d[he]=void 0;var h=!0}catch{}var c=Je.call(d);return h&&(l?d[he]=r:delete d[he]),c}var Xe=Object.prototype,Ze=Xe.toString;function et(d){return Ze.call(d)}var tt="[object Null]",st="[object Undefined]",Re=ye?ye.toStringTag:void 0;function at(d){return d==null?d===void 0?st:tt:Re&&Re in Object(d)?Qe(d):et(d)}function ot(d){return d!=null&&typeof d=="object"}var nt="[object Symbol]";function lt(d){return typeof d=="symbol"||ot(d)&&at(d)==nt}var it=/\s/;function rt(d){for(var l=d.length;l--&&it.test(d.charAt(l)););return l}var ct=/^\s+/;function ut(d){return d&&d.slice(0,rt(d)+1).replace(ct,"")}function Ce(d){var l=typeof d;return d!=null&&(l=="object"||l=="function")}var Oe=0/0,dt=/^[-+]0x[0-9a-f]+$/i,vt=/^0b[01]+$/i,ht=/^0o[0-7]+$/i,pt=parseInt;function Ie(d){if(typeof d=="number")return d;if(lt(d))return Oe;if(Ce(d)){var l=typeof d.valueOf=="function"?d.valueOf():d;d=Ce(l)?l+"":l}if(typeof d!="string")return d===0?d:+d;d=ut(d);var r=vt.test(d);return r||ht.test(d)?pt(d.slice(2),r?2:8):dt.test(d)?Oe:+d}var ft=function(){return je.Date.now()};const ke=ft;var gt="Expected a function",mt=Math.max,_t=Math.min;function yt(d,l,r){var h,c,m,p,_,k,b=0,O=!1,f=!1,T=!0;if(typeof d!="function")throw new TypeError(gt);l=Ie(l)||0,Ce(r)&&(O=!!r.leading,f="maxWait"in r,m=f?mt(Ie(r.maxWait)||0,l):m,T="trailing"in r?!!r.trailing:T);function S(R){var U=h,B=c;return h=c=void 0,b=R,p=d.apply(B,U),p}function D(R){return b=R,_=setTimeout(w,l),O?S(R):p}function I(R){var U=R-k,B=R-b,P=l-U;return f?_t(P,m-B):P}function j(R){var U=R-k,B=R-b;return k===void 0||U>=l||U<0||f&&B>=m}function w(){var R=ke();if(j(R))return $(R);_=setTimeout(w,I(R))}function $(R){return _=void 0,T&&h?S(R):(h=c=void 0,p)}function F(){_!==void 0&&clearTimeout(_),b=0,h=k=c=_=void 0}function L(){return _===void 0?p:$(ke())}function N(){var R=ke(),U=j(R);if(h=arguments,c=this,k=R,U){if(_===void 0)return D(k);if(f)return clearTimeout(_),_=setTimeout(w,l),S(k)}return _===void 0&&(_=setTimeout(w,l)),p}return N.cancel=F,N.flush=L,N}const kt={class:"search-filter"},bt={class:"search-container"},wt={class:"search-input-wrapper"},Ct=["placeholder","onKeydown"],St={key:0,class:"search-history"},$t=["onClick","onMouseenter"],Et={class:"history-text"},xt=["onClick"],Rt={key:1,class:"search-suggestions"},Ot=["onClick","onMouseenter"],It={class:"suggestion-text"},Tt={key:0,class:"filter-panel"},At={class:"filter-section"},jt={class:"filter-options"},Mt=["value"],Ft={class:"filter-section"},Lt={class:"filter-options"},Nt={class:"filter-option"},Ut={class:"filter-option"},Dt={class:"filter-option"},Bt={class:"filter-section"},Vt={key:0,class:"quick-filters"},Kt=["onClick"],Pt={key:1,class:"search-stats"},Yt={class:"stats-text"},Gt={key:0,class:"search-time"},pe="config-search-history",Ht=Se({__name:"SearchFilter",props:{modelValue:{},placeholder:{default:"搜索..."},searchScopes:{default:()=>[{value:"models",label:"Models"},{value:"rules",label:"Rules"},{value:"roles",label:"Roles"},{value:"commands",label:"Commands"}]},quickFilters:{default:()=>[]},maxHistory:{default:10}},emits:["update:modelValue","search","clear"],setup(d,{expose:l,emit:r}){const h=d,c=r,m=C(h.modelValue||""),p=C(null),_=C(!1),k=C(!1),b=C(!1),O=C(!1),f=C(-1),T=C(!1),S=C([]),D=C([]),I=C(h.searchScopes.map(s=>s.value)),j=C([]),w=C("relevance"),$=C({caseSensitive:!1,wholeWord:!1,highlightMatches:!0}),F=C(0),L=C(0),N=yt(s=>{if(s.trim()){const a=performance.now();c("search",s,{scopes:I.value,caseSensitive:$.value.caseSensitive,wholeWord:$.value.wholeWord,highlightMatches:$.value.highlightMatches,sortBy:w.value}),L.value=Math.round(performance.now()-a),O.value=!0}},300),R=()=>{c("update:modelValue",m.value),m.value?(_.value=!1,N(m.value),U()):(k.value=!1,c("clear"))},U=()=>{const s=[];if(m.value.length>2){const a=S.value.filter(E=>E.toLowerCase().includes(m.value.toLowerCase()));s.push(...a.slice(0,2));const i=["code","debug","architect","brain","hook","before","after"].filter(E=>E.toLowerCase().includes(m.value.toLowerCase()));s.push(...i.slice(0,3-s.length))}D.value=[...new Set(s)].slice(0,5),k.value=s.length>0},B=()=>{m.value="",c("update:modelValue",""),c("clear"),_.value=!1,k.value=!1,O.value=!1,f.value=-1,p.value&&p.value.focus()},P=()=>{b.value=!b.value},ce=()=>{T.value=!0,m.value||(_.value=!0,f.value=-1)},ue=()=>{T.value=!1,setTimeout(()=>{T.value||(_.value=!1,k.value=!1)},200)},W=()=>{m.value&&N(m.value)},Q=s=>{const a=j.value.indexOf(s);a>-1?j.value.splice(a,1):j.value.push(s),m.value&&N(m.value)},X=s=>{m.value=s,c("update:modelValue",s),_.value=!1,N(s),ne(s)},oe=s=>{m.value=s,c("update:modelValue",s),k.value=!1,N(s),ne(s)},ne=s=>{const a=s.trim();if(!a)return;const t=S.value.indexOf(a);t>-1&&S.value.splice(t,1),S.value.unshift(a),S.value.length>h.maxHistory&&(S.value=S.value.slice(0,h.maxHistory)),localStorage.setItem(pe,JSON.stringify(S.value))},y=s=>{S.value.splice(s,1),localStorage.setItem(pe,JSON.stringify(S.value)),S.value.length===0&&(_.value=!1)},g=()=>{S.value=[],localStorage.removeItem(pe),_.value=!1},x=()=>{const s=_.value?S.value:D.value;s.length>0&&(f.value=(f.value+1)%s.length)},H=()=>{const s=_.value?S.value:D.value;s.length>0&&(f.value=f.value<=0?s.length-1:f.value-1)},Z=()=>{const s=_.value?S.value:D.value;f.value>=0&&f.value<s.length&&(_.value?X(s[f.value]):oe(s[f.value]))};be(S,s=>{localStorage.setItem(pe,JSON.stringify(s))}),be(()=>h.modelValue,s=>{s!==m.value&&(m.value=s||"")}),l({setSearchResults:s=>{F.value=s},resetFilters:()=>{I.value=h.searchScopes.map(s=>s.value),j.value=[],$.value={caseSensitive:!1,wholeWord:!1,highlightMatches:!0},w.value="relevance"}}),Te(()=>{try{const s=localStorage.getItem(pe);s&&(S.value=JSON.parse(s))}catch(s){console.error("Failed to load search history:",s)}document.addEventListener("keydown",fe)}),Ue(()=>{document.removeEventListener("keydown",fe)});const fe=s=>{var a;(s.metaKey||s.ctrlKey)&&s.key==="k"&&(s.preventDefault(),(a=p.value)==null||a.focus()),s.key==="Escape"&&(b.value?b.value=!1:_.value||k.value?(_.value=!1,k.value=!1):B())};return(s,a)=>(n(),o("div",kt,[e("div",bt,[e("div",wt,[a[6]||(a[6]=e("div",{class:"search-icon"},"🔍",-1)),J(e("input",{ref_key:"searchInput",ref:p,"onUpdate:modelValue":a[0]||(a[0]=t=>m.value=t),type:"text",placeholder:s.placeholder,onInput:R,onFocus:ce,onBlur:ue,onKeydown:[ge(se(x,["prevent"]),["down"]),ge(se(H,["prevent"]),["up"]),ge(se(Z,["prevent"]),["enter"]),ge(se(B,["prevent"]),["esc"])]},null,40,Ct),[[_e,m.value]]),m.value?(n(),o("button",{key:0,class:"clear-btn",onClick:B,title:"清除搜索"}," ✕ ")):v("",!0),e("button",{class:V(["filter-toggle",{active:b.value}]),onClick:P,title:"筛选选项"}," ⚙️ ",2)]),_.value&&S.value.length>0&&!m.value?(n(),o("div",St,[e("div",{class:"history-header"},[a[7]||(a[7]=e("span",null,"搜索历史",-1)),e("button",{class:"clear-history",onClick:g,title:"清除历史"}," 清除 ")]),(n(!0),o(Y,null,G(S.value,(t,i)=>(n(),o("div",{key:i,class:V(["history-item",{highlighted:f.value===i}]),onClick:E=>X(t),onMouseenter:E=>f.value=i},[a[8]||(a[8]=e("span",{class:"history-icon"},"🕐",-1)),e("span",Et,u(t),1),e("button",{class:"remove-history",onClick:se(E=>y(i),["stop"]),title:"移除"}," ✕ ",8,xt)],42,$t))),128))])):v("",!0),k.value&&D.value.length>0?(n(),o("div",Rt,[(n(!0),o(Y,null,G(D.value,(t,i)=>(n(),o("div",{key:i,class:V(["suggestion-item",{highlighted:f.value===i}]),onClick:E=>oe(t),onMouseenter:E=>f.value=i},[a[9]||(a[9]=e("span",{class:"suggestion-icon"},"💡",-1)),e("span",It,u(t),1)],42,Ot))),128))])):v("",!0),we(Be,{name:"slide-down"},{default:De(()=>[b.value?(n(),o("div",Tt,[e("div",At,[a[10]||(a[10]=e("h3",null,"搜索范围",-1)),e("div",jt,[(n(!0),o(Y,null,G(s.searchScopes,t=>(n(),o("label",{key:t.value,class:"filter-option"},[J(e("input",{type:"checkbox",value:t.value,"onUpdate:modelValue":a[1]||(a[1]=i=>I.value=i),onChange:W},null,40,Mt),[[me,I.value]]),e("span",null,u(t.label),1)]))),128))])]),e("div",Ft,[a[14]||(a[14]=e("h3",null,"搜索选项",-1)),e("div",Lt,[e("label",Nt,[J(e("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=t=>$.value.caseSensitive=t),onChange:W},null,544),[[me,$.value.caseSensitive]]),a[11]||(a[11]=e("span",null,"区分大小写",-1))]),e("label",Ut,[J(e("input",{type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=t=>$.value.wholeWord=t),onChange:W},null,544),[[me,$.value.wholeWord]]),a[12]||(a[12]=e("span",null,"全词匹配",-1))]),e("label",Dt,[J(e("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=t=>$.value.highlightMatches=t),onChange:W},null,544),[[me,$.value.highlightMatches]]),a[13]||(a[13]=e("span",null,"高亮匹配",-1))])])]),e("div",Bt,[a[16]||(a[16]=e("h3",null,"排序方式",-1)),J(e("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>w.value=t),onChange:W,class:"sort-select"},[...a[15]||(a[15]=[e("option",{value:"relevance"},"相关度",-1),e("option",{value:"name"},"名称",-1),e("option",{value:"category"},"类别",-1),e("option",{value:"modified"},"修改时间",-1)])],544),[[Ve,w.value]])])])):v("",!0)]),_:1})]),s.quickFilters.length>0?(n(),o("div",Vt,[a[17]||(a[17]=e("span",{class:"quick-filter-label"},"快速筛选:",-1)),(n(!0),o(Y,null,G(s.quickFilters,t=>(n(),o("button",{key:t.value,class:V(["quick-filter-tag",{active:j.value.includes(t.value)}]),onClick:i=>Q(t.value)},u(t.label),11,Kt))),128))])):v("",!0),O.value&&m.value?(n(),o("div",Pt,[e("span",Yt,[a[18]||(a[18]=ae(" 找到 ",-1)),e("strong",null,u(F.value),1),a[19]||(a[19]=ae(" 个结果 ",-1)),L.value?(n(),o("span",Gt," ("+u(L.value)+"ms) ",1)):v("",!0)])])):v("",!0)]))}});const zt=$e(Ht,[["__scopeId","data-v-e8bbc804"]]);class Wt{constructor(){ve(this,"STORAGE_KEY","roo-configs");ve(this,"VERSION_KEY","roo-configs-version");ve(this,"BACKUP_KEY","roo-configs-backup");ve(this,"CURRENT_VERSION","1.0.0")}async initialize(){const l=localStorage.getItem(this.VERSION_KEY);l?l!==this.CURRENT_VERSION&&await this.migrateData(l,this.CURRENT_VERSION):await this.createBackup(),localStorage.setItem(this.VERSION_KEY,this.CURRENT_VERSION)}async saveConfig(l,r,h){try{const c=await this.getAllConfigs(),m={id:this.generateId(),name:l,description:h||"",config:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:this.CURRENT_VERSION},p=c.findIndex(k=>k.name===l);p>=0?c[p]={...c[p],config:r,description:h||c[p].description,updatedAt:new Date().toISOString()}:c.push(m);const _=this.compressData(c);localStorage.setItem(this.STORAGE_KEY,_),await this.createBackup()}catch(c){throw console.error("Failed to save config:",c),new Error("保存配置失败")}}async getAllConfigs(){try{const l=localStorage.getItem(this.STORAGE_KEY);return l?this.decompressData(l)||[]:[]}catch(l){throw console.error("Failed to load configs:",l),new Error("加载配置失败")}}async loadConfig(l){try{const h=(await this.getAllConfigs()).find(c=>c.id===l);return h?h.config:null}catch(r){throw console.error("Failed to load config:",r),new Error("加载配置失败")}}async deleteConfig(l){try{const h=(await this.getAllConfigs()).filter(m=>m.id!==l),c=this.compressData(h);localStorage.setItem(this.STORAGE_KEY,c),await this.createBackup()}catch(r){throw console.error("Failed to delete config:",r),new Error("删除配置失败")}}async renameConfig(l,r){try{const h=await this.getAllConfigs(),c=h.find(p=>p.id===l);if(!c)throw new Error("配置不存在");c.name=r,c.updatedAt=new Date().toISOString();const m=this.compressData(h);localStorage.setItem(this.STORAGE_KEY,m)}catch(h){throw console.error("Failed to rename config:",h),new Error("重命名配置失败")}}async exportConfig(l){try{const h=(await this.getAllConfigs()).find(_=>_.id===l);if(!h)throw new Error("配置不存在");const c=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),m=URL.createObjectURL(c),p=document.createElement("a");p.href=m,p.download=`config-${h.name}-${Date.now()}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(m)}catch(r){throw console.error("Failed to export config:",r),new Error("导出配置失败")}}async importConfig(l){try{const r=await l.text(),h=JSON.parse(r);if(!this.validateConfig(h))throw new Error("配置格式无效");h.id=this.generateId(),h.updatedAt=new Date().toISOString();const c=await this.getAllConfigs();c.push(h);const m=this.compressData(c);localStorage.setItem(this.STORAGE_KEY,m),await this.createBackup()}catch(r){throw console.error("Failed to import config:",r),new Error("导入配置失败")}}async createBackup(){try{const l=localStorage.getItem(this.STORAGE_KEY);l&&(localStorage.setItem(this.BACKUP_KEY,l),localStorage.setItem(`${this.BACKUP_KEY}-timestamp`,Date.now().toString()))}catch(l){console.error("Failed to create backup:",l)}}async restoreBackup(){try{const l=localStorage.getItem(this.BACKUP_KEY);return l?(localStorage.setItem(this.STORAGE_KEY,l),!0):!1}catch(l){throw console.error("Failed to restore backup:",l),new Error("恢复备份失败")}}compressData(l){try{const r=JSON.stringify(l);return btoa(unescape(encodeURIComponent(r)))}catch(r){return console.error("Compression failed:",r),JSON.stringify(l)}}decompressData(l){try{const r=decodeURIComponent(escape(atob(l)));return JSON.parse(r)}catch(r){try{return JSON.parse(l)}catch{return console.error("Decompression failed:",r),null}}}async migrateData(l,r){console.log(`Migrating from ${l} to ${r}`),await this.createBackup()}validateConfig(l){return l&&typeof l.id=="string"&&typeof l.name=="string"&&typeof l.config=="object"&&Array.isArray(l.config.models)&&typeof l.config.rules=="object"}generateId(){return`config_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async getStorageStats(){const l=await this.getAllConfigs(),r=localStorage.getItem(this.STORAGE_KEY),h=localStorage.getItem(`${this.BACKUP_KEY}-timestamp`);return{totalConfigs:l.length,totalSize:r?new Blob([r]).size:0,lastBackup:h?new Date(parseInt(h)):void 0}}}const z=new Wt,Fe=Ke("config",()=>{const d=C([]),l=C(!1),r=C(null),h=C({totalConfigs:0,totalSize:0}),c=K(()=>d.value.length>0),m=K(()=>[...d.value].sort((w,$)=>new Date($.updatedAt).getTime()-new Date(w.updatedAt).getTime())),p=async()=>{try{l.value=!0,await z.initialize(),await _(),await I()}catch(w){r.value=w instanceof Error?w.message:"初始化失败"}finally{l.value=!1}},_=async()=>{try{l.value=!0,r.value=null,d.value=await z.getAllConfigs()}catch(w){throw r.value=w instanceof Error?w.message:"加载配置失败",w}finally{l.value=!1}},k=async(w,$,F)=>{try{return l.value=!0,r.value=null,await z.saveConfig(w,$,F),await _(),await I(),!0}catch(L){throw r.value=L instanceof Error?L.message:"保存配置失败",L}finally{l.value=!1}},b=async w=>{try{return l.value=!0,r.value=null,await z.loadConfig(w)}catch($){throw r.value=$ instanceof Error?$.message:"加载配置失败",$}finally{l.value=!1}},O=async w=>{try{l.value=!0,r.value=null,await z.deleteConfig(w),await _(),await I()}catch($){throw r.value=$ instanceof Error?$.message:"删除配置失败",$}finally{l.value=!1}},f=async(w,$)=>{try{l.value=!0,r.value=null,await z.renameConfig(w,$),await _()}catch(F){throw r.value=F instanceof Error?F.message:"重命名配置失败",F}finally{l.value=!1}},T=async w=>{try{await z.exportConfig(w)}catch($){throw r.value=$ instanceof Error?$.message:"导出配置失败",$}},S=async w=>{try{l.value=!0,r.value=null,await z.importConfig(w),await _(),await I()}catch($){throw r.value=$ instanceof Error?$.message:"导入配置失败",$}finally{l.value=!1}},D=async()=>{try{l.value=!0,r.value=null;const w=await z.restoreBackup();return w&&(await _(),await I()),w}catch(w){throw r.value=w instanceof Error?w.message:"恢复备份失败",w}finally{l.value=!1}},I=async()=>{try{h.value=await z.getStorageStats()}catch(w){console.error("Failed to update storage stats:",w)}};return{savedConfigs:d,isLoading:l,error:r,storageStats:h,hasConfigs:c,sortedConfigs:m,initialize:p,loadConfigs:_,saveConfig:k,loadConfig:b,deleteConfig:O,renameConfig:f,exportConfig:T,importConfig:S,restoreBackup:D,updateStorageStats:I,clearError:()=>{r.value=null}}}),qt=Object.freeze(Object.defineProperty({__proto__:null,useConfigStore:Fe},Symbol.toStringTag,{value:"Module"})),Jt={key:0,class:"config-manager"},Qt={class:"modal-content"},Xt={class:"modal-header"},Zt={key:0,class:"config-form"},es={class:"form-group"},ts={key:0,class:"error-message"},ss={class:"form-group"},as={class:"form-actions"},os=["disabled"],ns={key:1,class:"config-list"},ls={key:0,class:"loading"},is={key:1,class:"empty-state"},rs={key:2,class:"configs-container"},cs={class:"toolbar"},us={class:"toolbar-info"},ds={class:"config-count"},vs={class:"storage-size"},hs={class:"toolbar-actions"},ps=["disabled"],fs=["disabled"],gs={class:"configs-grid"},ms={class:"config-card-header"},_s={class:"config-info"},ys={key:0,class:"description"},ks={class:"meta"},bs={class:"date"},ws={key:0,class:"date"},Cs={class:"config-card-content"},Ss={class:"config-preview"},$s={class:"preview-item"},Es={class:"value"},xs={class:"preview-item"},Rs={class:"value"},Os={class:"preview-item"},Is={class:"value"},Ts={class:"config-actions"},As=["onClick"],js=["onClick"],Ms=["onClick"],Fs=["onClick"],Ls=["onClick"],Ns=Se({__name:"ConfigManager",props:{show:{type:Boolean,default:!1},initialMode:{default:"list"},currentConfig:{default:void 0}},emits:["update:show","apply","close"],setup(d,{emit:l}){const r=d,h=l,c=Fe(),m=C(r.initialMode),p=C(""),_=C(""),k=C(!1),b=C({}),O=C(),f=K(()=>c.savedConfigs),T=K(()=>c.sortedConfigs),S=K(()=>c.hasConfigs),D=K(()=>c.storageStats),I=()=>{h("update:show",!1),Q()},j=y=>{m.value=y,y==="save"&&Ae(()=>{const g=document.querySelector('input[type="text"]');g==null||g.focus()})},w=()=>p.value.trim()?f.value.find(g=>g.name===p.value.trim())?(b.value.name="配置名称已存在",!1):(delete b.value.name,!0):(b.value.name="配置名称不能为空",!1),$=async()=>{if(!(!w()||!r.currentConfig))try{k.value=!0,await c.saveConfig(p.value.trim(),r.currentConfig,_.value.trim()||void 0),m.value="list",Q()}catch(y){console.error("Save failed:",y)}finally{k.value=!1}},F=y=>{h("apply",y.config),I()},L=y=>{console.log("Load config details:",y)},N=async y=>{try{await c.exportConfig(y)}catch(g){console.error("Export failed:",g)}},R=async y=>{const g=prompt("请输入新的配置名称:",y.name);if(g&&g.trim()&&g.trim()!==y.name)try{await c.renameConfig(y.id,g.trim())}catch(x){console.error("Rename failed:",x)}},U=async y=>{if(confirm(`确定要删除配置 "${y.name}" 吗？此操作不可恢复。`))try{await c.deleteConfig(y.id)}catch(g){console.error("Delete failed:",g)}},B=async()=>{try{k.value=!0,await c.loadConfigs(),await c.updateStorageStats()}catch(y){console.error("Refresh failed:",y)}finally{k.value=!1}},P=()=>{var y;(y=O.value)==null||y.click()},ce=async y=>{var H;const g=y.target,x=(H=g.files)==null?void 0:H[0];if(x)try{k.value=!0,await c.importConfig(x)}catch(Z){console.error("Import failed:",Z)}finally{k.value=!1,g.value=""}},ue=()=>{const y=new Blob([JSON.stringify(f.value,null,2)],{type:"application/json"}),g=URL.createObjectURL(y),x=document.createElement("a");x.href=g,x.download=`all-configs-${Date.now()}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(g)},W=async()=>{if(confirm("确定要恢复到最近的备份吗？这将覆盖当前的配置。"))try{const y=await c.restoreBackup();alert(y?"备份恢复成功！":"没有找到可用的备份")}catch(y){console.error("Restore backup failed:",y),alert("恢复备份失败")}},Q=()=>{p.value="",_.value="",b.value={}},X=y=>new Date(y).toLocaleDateString("zh-CN"),oe=y=>y<1024?y+" B":y<1024*1024?(y/1024).toFixed(1)+" KB":(y/(1024*1024)).toFixed(1)+" MB",ne=K(()=>m.value==="save"?"保存配置":"我的配置");return be(()=>r.show,y=>{y&&(m.value=r.initialMode,Q(),c.clearError())}),(y,g)=>y.show?(n(),o("div",Jt,[e("div",{class:"modal-backdrop",onClick:I}),e("div",Qt,[e("div",Xt,[e("h2",null,u(ne.value),1),e("button",{class:"close-btn",onClick:I},"✕")]),m.value==="save"?(n(),o("div",Zt,[e("div",es,[g[4]||(g[4]=e("label",null,[ae("配置名称 "),e("span",{class:"required"},"*")],-1)),J(e("input",{"onUpdate:modelValue":g[0]||(g[0]=x=>p.value=x),type:"text",placeholder:"输入配置名称...",class:V({error:b.value.name}),onInput:w},null,34),[[_e,p.value]]),b.value.name?(n(),o("span",ts,u(b.value.name),1)):v("",!0)]),e("div",ss,[g[5]||(g[5]=e("label",null,"描述（可选）",-1)),J(e("textarea",{"onUpdate:modelValue":g[1]||(g[1]=x=>_.value=x),placeholder:"添加配置描述...",rows:"3"},null,512),[[_e,_.value]])]),e("div",as,[e("button",{class:"btn btn-primary",disabled:!p.value.trim()||k.value,onClick:$},u(k.value?"保存中...":"保存配置"),9,os),e("button",{class:"btn btn-secondary",onClick:I},"取消")])])):m.value==="list"?(n(),o("div",ns,[k.value?(n(),o("div",ls,[...g[6]||(g[6]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"加载中...",-1)])])):S.value?(n(),o("div",rs,[e("div",cs,[e("div",us,[e("span",ds,u(f.value.length)+" 个配置",1),e("span",vs,"占用空间: "+u(oe(D.value.totalSize)),1)]),e("div",hs,[e("button",{class:"btn-icon",title:"刷新",onClick:B,disabled:k.value}," 🔄 ",8,ps),e("button",{class:"btn-icon",title:"导入配置",onClick:P}," 📥 "),e("button",{class:"btn-icon",title:"导出所有",onClick:ue}," 📤 "),e("button",{class:"btn-icon",title:"恢复备份",onClick:W,disabled:k.value}," 💾 ",8,fs),e("button",{class:"btn-icon btn-primary",title:"创建新配置",onClick:g[3]||(g[3]=x=>j("save"))}," ➕ ")])]),e("div",gs,[(n(!0),o(Y,null,G(T.value,x=>{var H,Z,de;return n(),o("div",{key:x.id,class:"config-card"},[e("div",ms,[e("div",_s,[e("h3",null,u(x.name),1),x.description?(n(),o("p",ys,u(x.description),1)):v("",!0),e("div",ks,[e("span",bs,"创建于: "+u(X(x.createdAt)),1),x.updatedAt!==x.createdAt?(n(),o("span",ws," 更新于: "+u(X(x.updatedAt)),1)):v("",!0)])])]),e("div",Cs,[e("div",Ss,[e("div",$s,[g[9]||(g[9]=e("span",{class:"label"},"Models:",-1)),e("span",Es,u(((H=x.config.models)==null?void 0:H.length)||0)+" 个",1)]),e("div",xs,[g[10]||(g[10]=e("span",{class:"label"},"Roles:",-1)),e("span",Rs,u(((Z=x.config.roles)==null?void 0:Z.length)||0)+" 个",1)]),e("div",Os,[g[11]||(g[11]=e("span",{class:"label"},"Commands:",-1)),e("span",Is,u(((de=x.config.commands)==null?void 0:de.length)||0)+" 个",1)])]),e("div",Ts,[e("button",{class:"btn-sm btn-primary",onClick:le=>F(x),title:"应用此配置"}," 应用 ",8,As),e("button",{class:"btn-sm btn-secondary",onClick:le=>L(x),title:"查看详情"}," 详情 ",8,js),e("button",{class:"btn-sm",onClick:le=>N(x.id),title:"导出配置"}," 📤 ",8,Ms),e("button",{class:"btn-sm",onClick:le=>R(x),title:"重命名"}," ✏️ ",8,Fs),e("button",{class:"btn-sm btn-danger",onClick:le=>U(x),title:"删除配置"}," 🗑️ ",8,Ls)])])])}),128))])])):(n(),o("div",is,[g[7]||(g[7]=e("div",{class:"empty-icon"},"📁",-1)),g[8]||(g[8]=e("p",null,"暂无保存的配置",-1)),e("button",{class:"btn btn-primary",onClick:g[2]||(g[2]=x=>j("save"))}," 创建新配置 ")]))])):v("",!0)]),e("input",{ref_key:"fileInput",ref:O,type:"file",accept:".json",style:{display:"none"},onChange:ce},null,544)])):v("",!0)}});const Us=$e(Ns,[["__scopeId","data-v-b7c5d379"]]);const Ds={class:"config-selector"},Bs={class:"container"},Vs={class:"global-search-section"},Ks={class:"config-layout"},Ps={class:"selection-panel"},Ys={class:"config-section"},Gs={class:"search-box"},Hs={class:"items-list"},zs=["onClick"],Ws={class:"item-header"},qs=["checked","onChange","disabled","title"],Js={class:"item-info"},Qs={class:"text-primary"},Xs={key:0,class:"required-crown",title:"必选项"},Zs={class:"slug text-secondary"},ea={key:0,class:"description text-secondary"},ta={key:1,class:"meta"},sa={class:"category text-inverted"},aa={key:0,class:"tags text-secondary"},oa={key:2,class:"model-rules"},na={class:"model-rules-header"},la={class:"model-rules-actions"},ia=["onClick","title"],ra={class:"model-rules-list"},ca=["onClick"],ua={class:"rule-header"},da=["checked","onChange","disabled"],va={class:"rule-info"},ha={class:"text-primary"},pa={key:0,class:"rule-preview"},fa={key:0,class:"rule-metadata-simple"},ga={key:0,class:"rule-title"},ma={key:1,class:"rule-description"},_a={key:2,class:"rule-meta-info"},ya={key:0,class:"category-tag"},ka={key:1,class:"tags"},ba={key:1,class:"rule-content-preview"},wa={key:0,class:"rule-metadata-header"},Ca={key:0,class:"meta-description"},Sa={key:1},$a={class:"config-section"},Ea={class:"items-list"},xa=["onClick"],Ra={class:"item-header"},Oa=["checked","onChange"],Ia={class:"item-info"},Ta={class:"text-primary"},Aa={key:0,class:"role-preview"},ja={key:0,class:"role-metadata-simple"},Ma={key:0,class:"role-title"},Fa={key:1,class:"role-description"},La={key:2,class:"role-traits"},Na={class:"traits-value"},Ua={key:1,class:"role-content-preview"},Da={key:0,class:"role-metadata-header"},Ba={key:0,class:"meta-description"},Va={key:1},Ka={class:"config-section"},Pa={class:"items-list"},Ya=["onClick"],Ga={class:"item-header"},Ha=["checked","onChange"],za={class:"item-info"},Wa={class:"text-primary"},qa={key:0,class:"command-preview"},Ja={key:0,class:"command-metadata-simple"},Qa={key:0,class:"command-title"},Xa={key:1,class:"command-description"},Za={key:2,class:"command-meta-info"},eo={key:0,class:"category-tag"},to={key:1,class:"tags"},so={key:1,class:"command-content-preview"},ao={key:0,class:"command-metadata-header"},oo={key:0,class:"meta-description"},no={key:1},lo={class:"preview-panel"},io={class:"preview-section"},ro={class:"preview-header"},co={class:"preview-controls"},uo={class:"mode-toggle"},vo={key:0,class:"preview-content"},ho={class:"preview-grid"},po={key:0,class:"preview-card"},fo={class:"card-header"},go={class:"card-content"},mo={class:"model-name"},_o={class:"name-text"},yo={class:"slug-text"},ko={key:0,class:"model-metadata-simple"},bo={key:0,class:"meta-description"},wo={key:1,class:"model-meta-info"},Co={key:0,class:"category-tag"},So={key:1,class:"tags"},$o={key:1,class:"rules-count"},Eo={class:"count-badge"},xo={key:1,class:"preview-card"},Ro={class:"card-content"},Oo={class:"role-item"},Io={class:"name-text"},To={key:0,class:"role-metadata-simple"},Ao={key:0,class:"meta-description"},jo={key:1,class:"role-traits"},Mo={class:"traits-value"},Fo={key:2,class:"preview-card"},Lo={class:"card-header"},No={class:"card-content"},Uo={class:"commands-grid"},Do={class:"command-name"},Bo={key:0,class:"command-metadata-simple"},Vo={key:0,class:"meta-description"},Ko={key:1,class:"command-meta-info"},Po={key:0,class:"category-tag"},Yo={key:1,class:"preview-card"},Go={class:"card-header"},Ho={class:"card-content"},zo={class:"hooks-list"},Wo={key:0,class:"hook-item"},qo={key:0,class:"hook-metadata-simple"},Jo={key:0,class:"meta-description"},Qo={key:1,class:"hook-description"},Xo={key:2,class:"hook-meta-info"},Zo={class:"category-tag"},en={key:1,class:"hook-item"},tn={key:0,class:"hook-metadata-simple"},sn={key:0,class:"meta-description"},an={key:1,class:"hook-description"},on={key:2,class:"hook-meta-info"},nn={class:"category-tag"},ln={key:2,class:"empty-preview"},rn={class:"actions"},cn=["disabled"],A="orchestrator",re=100,un=300,dn=Se({__name:"ConfigSelector",setup(d){const r=((s,a)=>{let t;return function(...i){clearTimeout(t),t=window.setTimeout(()=>s.apply(this,i),a)}})(()=>{},un),h=C([]),c=C([]),m=C({}),p=C(null),_=C({}),k=C([]),b=C({before:"",after:""}),O=C({}),f=C({}),T=C(""),S=C("detailed");C(!1);const D=C(null),I=C(!1),j=C("");C();const w=K(()=>c.value.length>0||Object.keys(f.value).length>0||p.value!==null||k.value.length>0),$=K(()=>c.value.length>0);K(()=>c.value.some(s=>s.slug===A)),K(()=>Object.values(f.value).reduce((s,a)=>s+a.length,0));const F=(s,a)=>{var t;return((t=f.value[s])==null?void 0:t.includes(a))||!1},L=s=>{const a=Object.keys(O.value[s]||{}),t=f.value[s]||[];return a.length>0&&a.every(i=>t.includes(i))},N=K(()=>{const s=T.value.toLowerCase();return s?h.value.filter(a=>{var t,i,E;return a.name.toLowerCase().includes(s)||a.slug.toLowerCase().includes(s)||((t=a.description)==null?void 0:t.toLowerCase().includes(s))||((i=a.category)==null?void 0:i.toLowerCase().includes(s))||((E=a.tags)==null?void 0:E.some(M=>M.toLowerCase().includes(s)))}):h.value}),R=(s,a)=>{console.error(`Failed to ${a}:`,s),s.value=`${a} 失败`},U=()=>{D.value=null},B=async()=>{U();try{const s=await ie.get("/api/models");h.value=s.data;const a=h.value.find(t=>t.slug===A);a&&(c.value.push(a),await P(A))}catch(s){R(s,"fetch models")}},P=async s=>{U();try{const t=(await ie.get(`/api/rules/${s}`)).data;O.value[s]=t,s===A?f.value[s]=Object.keys(t):f.value[s]=[]}catch(a){R(a,`fetch rules for ${s}`)}},ce=async()=>{try{const s=await ie.get("/api/roles");m.value=s.data}catch(s){console.error("Failed to fetch roles:",s)}},ue=async()=>{try{const s=await ie.get("/api/commands");_.value=s.data}catch(s){console.error("Failed to fetch commands:",s)}},W=async()=>{try{const[s,a]=await Promise.all([ie.get("/api/hooks/before"),ie.get("/api/hooks/after")]);b.value={before:s.data,after:a.data}}catch(s){console.error("Failed to fetch hooks:",s)}},Q=async s=>{const a=c.value.findIndex(t=>t.slug===s.slug);if(a>-1){if(s.slug===A)return;c.value.splice(a,1),delete f.value[s.slug],delete O.value[s.slug]}else{c.value.push(s);try{const i=(await ie.get(`/api/rules/${s.slug}`)).data;O.value[s.slug]=i,s.slug===A?f.value[s.slug]=Object.keys(i):f.value[s.slug]=[]}catch(t){console.error(`Failed to fetch rules for ${s.slug}:`,t)}}},X=(s,a)=>{var t;((t=p.value)==null?void 0:t.name)===s?p.value=null:p.value={name:s,content:a.content}},oe=(s,a)=>{const t=k.value.findIndex(i=>i.name===s);t>-1?k.value.splice(t,1):k.value.push({name:s,content:a.content})},ne=(s,a,t)=>{if(s===A)return;f.value[s]||(f.value[s]=[]);const i=f.value[s].indexOf(a);i>-1?f.value[s].splice(i,1):f.value[s].push(a)},y=s=>{if(s===A)return;const a=Object.keys(O.value[s]||{});f.value[s],L(s)?f.value[s]=[]:f.value[s]=[...a]},g=()=>{const s=c.value.find(a=>a.slug===A);c.value=s?[s]:[],O.value={},f.value={},p.value=null,k.value=[],T.value="",s&&P(s.slug)},x=()=>{const s={models:c.value,rules:{},roles:p.value?[p.value]:[],commands:k.value,hooks:b.value};c.value.forEach(M=>{const ee=f.value[M.slug]||[];s.rules[M.slug]=ee.map(te=>{var Ee;const q=(Ee=O.value[M.slug])==null?void 0:Ee[te];return{name:te,content:(q==null?void 0:q.content)||""}})});const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),i=document.createElement("a");i.href=t;const E=c.value.map(M=>M.slug).join("-");i.download=`config-${E}-${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)};Te(async()=>{await Promise.all([B(),ce(),ue(),W()]),Ae(()=>{if(h.value.length>0&&!c.value.some(s=>s.slug===A)){const s=h.value.find(a=>a.slug===A);s&&(c.value.push(s),P(s.slug))}})});const H=(s,a)=>{j.value=s;const t=(i,E)=>{if(!s)return i;const M=s.toLowerCase();return i.filter(ee=>E.some(te=>{const q=ee[te];return typeof q=="string"?q.toLowerCase().includes(M):!1}))};switch(a.scope){case"models":N.value=t(h.value,["name","slug","description"]);break;case"rules":break;case"roles":break;case"commands":break;default:N.value=t(h.value,["name","slug","description"])}},Z=s=>{H(j.value,s)},de=()=>{I.value=!0},le=async s=>{const a={models:c.value,rules:{},roles:p.value?[p.value]:[],commands:k.value,hooks:b.value};c.value.forEach(E=>{const M=f.value[E.slug]||[];a.rules[E.slug]=M.map(ee=>{var q;const te=(q=O.value[E.slug])==null?void 0:q[ee];return{name:ee,content:(te==null?void 0:te.content)||""}})});const{useConfigStore:t}=await Pe(()=>Promise.resolve().then(()=>qt),void 0),i=t();try{await i.saveConfig(s,a)}catch(E){console.error("保存配置失败:",E)}},fe=async s=>{if(g(),s.models&&Array.isArray(s.models)){c.value=s.models;for(const a of s.models)await P(a.slug),s.rules&&s.rules[a.slug]&&(f.value[a.slug]=s.rules[a.slug].map(t=>t.name))}if(s.roles&&s.roles.length>0){const a=s.roles[0];p.value=a}s.commands&&Array.isArray(s.commands)&&(k.value=s.commands)};return(s,a)=>(n(),o("div",Ds,[e("div",Bs,[a[23]||(a[23]=e("div",{class:"header"},[e("h1",null,"配置选择器"),e("p",{class:"description"},"选择您需要的 models、rules、roles 和 commands")],-1)),e("div",Vs,[we(zt,{"initial-query":j.value,placeholder:"搜索 modes, rules, roles, commands...",scopes:[{value:"all",label:"全部"},{value:"models",label:"Modes"},{value:"rules",label:"Rules"},{value:"roles",label:"Roles"},{value:"commands",label:"Commands"}],"quick-filters":[{value:"selected",label:"已选择"},{value:"recent",label:"最近更新"}],onSearch:H,onFilterChange:Z},null,8,["initial-query"])]),e("div",Ks,[e("div",Ps,[e("div",Ys,[a[7]||(a[7]=e("h2",null,[ae("模式 "),e("span",{class:"required"},"*")],-1)),e("div",Gs,[a[6]||(a[6]=e("div",{class:"search-icon"},"🔍",-1)),J(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>T.value=t),type:"text",placeholder:"搜索模式...",onInput:a[1]||(a[1]=(...t)=>xe(r)&&xe(r)(...t))},null,544),[[_e,T.value]]),T.value?(n(),o("button",{key:0,class:"clear-btn",onClick:a[2]||(a[2]=t=>{T.value=""})}," ✕ ")):v("",!0)]),e("div",Hs,[(n(!0),o(Y,null,G(N.value,t=>(n(),o("div",{key:t.slug,class:V(["item-card",{selected:c.value.some(i=>i.slug===t.slug)}]),onClick:i=>Q(t)},[e("div",Ws,[e("input",{type:"checkbox",checked:c.value.some(i=>i.slug===t.slug),onChange:i=>Q(t),disabled:t.slug===A,title:t.slug===A?"Orchestrator模式为必选项，不可取消":"",class:V(["custom-checkbox",{"required-checkbox":t.slug===A}])},null,42,qs),e("div",Js,[e("h3",Qs,[ae(u(t.name)+" ",1),t.slug===A?(n(),o("span",Xs,"👑")):v("",!0)]),e("p",Zs,u(t.slug),1)])]),t.description?(n(),o("p",ea,u(t.description),1)):v("",!0),t.category?(n(),o("div",ta,[e("span",sa,u(t.category),1),t.tags?(n(),o("span",aa,u(t.tags.join(", ")),1)):v("",!0)])):v("",!0),c.value.some(i=>i.slug===t.slug)&&O.value[t.slug]?(n(),o("div",oa,[e("div",na,[e("h4",null,u(t.name)+" 的规则",1),e("div",la,[e("button",{class:"action-btn",onClick:se(i=>y(t.slug),["stop"]),title:L(t.slug)?"取消全选":"全选"},u(L(t.slug)?"取消全选":"全选"),9,ia)])]),e("div",ra,[(n(!0),o(Y,null,G(O.value[t.slug],(i,E)=>(n(),o("div",{key:E,class:V(["rule-item",{selected:F(t.slug,E),disabled:t.slug===A}]),onClick:se(M=>t.slug!==A&&ne(t.slug,E),["stop"])},[e("div",ua,[e("input",{type:"checkbox",checked:F(t.slug,E),onChange:se(M=>ne(t.slug,E),["stop"]),disabled:t.slug===A,class:"custom-checkbox"},null,40,da),e("div",va,[e("h5",ha,u(E),1)])]),i.content||i.metadata?(n(),o("div",pa,[S.value==="simple"&&i.metadata?(n(),o("div",fa,[i.metadata.title?(n(),o("h5",ga,u(i.metadata.title),1)):v("",!0),i.metadata.description?(n(),o("p",ma,u(i.metadata.description),1)):v("",!0),i.metadata.category||i.metadata.tags?(n(),o("div",_a,[i.metadata.category?(n(),o("span",ya,u(i.metadata.category),1)):v("",!0),i.metadata.tags&&i.metadata.tags.length>0?(n(),o("span",ka,u(i.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):(n(),o("div",ba,[i.metadata?(n(),o("div",wa,[e("h5",null,u(i.metadata.title||E),1),i.metadata.description?(n(),o("p",Ca,u(i.metadata.description),1)):v("",!0)])):v("",!0),i.content?(n(),o("pre",Sa,u(i.content.substring(0,re))+u(i.content.length>re?"...":""),1)):v("",!0)]))])):v("",!0)],10,ca))),128))])])):v("",!0)],10,zs))),128))])]),e("div",$a,[a[9]||(a[9]=e("h2",null,"角色 (可选)",-1)),e("div",Ea,[(n(!0),o(Y,null,G(m.value,(t,i)=>{var E,M;return n(),o("div",{key:i,class:V(["item-card",{selected:((E=p.value)==null?void 0:E.name)===i}]),onClick:ee=>X(i,t)},[e("div",Ra,[e("input",{type:"radio",name:"role",checked:((M=p.value)==null?void 0:M.name)===i,onChange:ee=>X(i,t),class:"custom-radio"},null,40,Oa),e("div",Ia,[e("h3",Ta,u(i),1)])]),t.content||t.metadata?(n(),o("div",Aa,[S.value==="simple"&&t.metadata?(n(),o("div",ja,[t.metadata.title?(n(),o("h5",Ma,u(t.metadata.title),1)):v("",!0),t.metadata.description?(n(),o("p",Fa,u(t.metadata.description),1)):v("",!0),t.metadata.traits?(n(),o("div",La,[a[8]||(a[8]=e("span",{class:"traits-label"},"特质:",-1)),e("span",Na,u(Array.isArray(t.metadata.traits)?t.metadata.traits.join(", "):t.metadata.traits),1)])):v("",!0)])):(n(),o("div",Ua,[t.metadata?(n(),o("div",Da,[e("h5",null,u(t.metadata.title||i),1),t.metadata.description?(n(),o("p",Ba,u(t.metadata.description),1)):v("",!0)])):v("",!0),t.content?(n(),o("p",Va,u(t.content.substring(0,re))+u(t.content.length>re?"...":""),1)):v("",!0)]))])):v("",!0)],10,xa)}),128))])]),e("div",Ka,[a[10]||(a[10]=e("h2",null,"命令",-1)),e("div",Pa,[(n(!0),o(Y,null,G(_.value,(t,i)=>(n(),o("div",{key:i,class:V(["item-card",{selected:k.value.some(E=>E.name===i)}]),onClick:E=>oe(i,t)},[e("div",Ga,[e("input",{type:"checkbox",checked:k.value.some(E=>E.name===i),onChange:E=>oe(i,t),class:"custom-checkbox"},null,40,Ha),e("div",za,[e("h3",Wa,u(i),1)])]),t.content||t.metadata?(n(),o("div",qa,[S.value==="simple"&&t.metadata?(n(),o("div",Ja,[t.metadata.title?(n(),o("h5",Qa,u(t.metadata.title),1)):v("",!0),t.metadata.description?(n(),o("p",Xa,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.tags?(n(),o("div",Za,[t.metadata.category?(n(),o("span",eo,u(t.metadata.category),1)):v("",!0),t.metadata.tags&&t.metadata.tags.length>0?(n(),o("span",to,u(t.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):(n(),o("div",so,[t.metadata?(n(),o("div",ao,[e("h5",null,u(t.metadata.title||i),1),t.metadata.description?(n(),o("p",oo,u(t.metadata.description),1)):v("",!0)])):v("",!0),t.content?(n(),o("pre",no,u(t.content.substring(0,re))+u(t.content.length>re?"...":""),1)):v("",!0)]))])):v("",!0)],10,Ya))),128))])])]),e("div",lo,[e("div",io,[e("div",ro,[a[11]||(a[11]=e("h2",null,"配置预览",-1)),e("div",co,[e("div",uo,[e("button",{class:V(["mode-btn",{active:S.value==="detailed"}]),onClick:a[3]||(a[3]=t=>S.value="detailed")}," 详细 ",2),e("button",{class:V(["mode-btn",{active:S.value==="simple"}]),onClick:a[4]||(a[4]=t=>S.value="simple")}," 简洁 ",2)])])]),w.value?(n(),o("div",vo,[e("div",ho,[c.value.length>0?(n(),o("div",po,[e("div",fo,[a[12]||(a[12]=e("div",{class:"card-icon"},"🤖",-1)),e("h3",null,"模式 ("+u(c.value.length)+")",1)]),e("div",go,[(n(!0),o(Y,null,G(c.value,t=>(n(),o("div",{key:t.slug,class:"model-item"},[e("div",mo,[e("span",_o,u(t.name),1),e("span",yo,"("+u(t.slug)+")",1)]),S.value==="simple"&&t.metadata?(n(),o("div",ko,[t.metadata.description?(n(),o("p",bo,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.tags?(n(),o("div",wo,[t.metadata.category?(n(),o("span",Co,u(t.metadata.category),1)):v("",!0),t.metadata.tags&&t.metadata.tags.length>0?(n(),o("span",So,u(t.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):f.value[t.slug]&&f.value[t.slug].length>0?(n(),o("div",$o,[e("span",Eo,u(f.value[t.slug].length)+" rules",1)])):v("",!0)]))),128))])])):v("",!0),p.value?(n(),o("div",xo,[a[14]||(a[14]=e("div",{class:"card-header"},[e("div",{class:"card-icon"},"🎭"),e("h3",null,"选择的角色")],-1)),e("div",Ro,[e("div",Oo,[e("span",Io,u(p.value.name),1),S.value==="simple"&&p.value.metadata?(n(),o("div",To,[p.value.metadata.description?(n(),o("p",Ao,u(p.value.metadata.description),1)):v("",!0),p.value.metadata.traits?(n(),o("div",jo,[a[13]||(a[13]=e("span",{class:"traits-label"},"特质:",-1)),e("span",Mo,u(Array.isArray(p.value.metadata.traits)?p.value.metadata.traits.join(", "):p.value.metadata.traits),1)])):v("",!0)])):v("",!0)])])])):v("",!0),k.value.length>0?(n(),o("div",Fo,[e("div",Lo,[a[15]||(a[15]=e("div",{class:"card-icon"},"⚡",-1)),e("h3",null,"命令 ("+u(k.value.length)+")",1)]),e("div",No,[e("div",Uo,[(n(!0),o(Y,null,G(k.value,t=>(n(),o("div",{key:t.name,class:"command-chip"},[e("span",Do,u(t.name),1),S.value==="simple"&&t.metadata?(n(),o("div",Bo,[t.metadata.description?(n(),o("p",Vo,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.priority?(n(),o("div",Ko,[t.metadata.category?(n(),o("span",Po,u(t.metadata.category),1)):v("",!0),t.metadata.priority?(n(),o("span",{key:1,class:V(["priority-tag",t.metadata.priority])},u(t.metadata.priority),3)):v("",!0)])):v("",!0)])):v("",!0)]))),128))])])])):v("",!0)])])):v("",!0),b.value.before||b.value.after?(n(),o("div",Yo,[e("div",Go,[a[16]||(a[16]=e("div",{class:"card-icon"},"🔗",-1)),e("h3",null,"钩子 ("+u((b.value.before?1:0)+(b.value.after?1:0))+")",1)]),e("div",Ho,[e("div",zo,[b.value.before?(n(),o("div",Wo,[a[17]||(a[17]=e("div",{class:"hook-name"},[e("span",{class:"name-text"},"before"),e("span",{class:"hook-type"},"前置钩子")],-1)),S.value==="simple"&&b.value.before.metadata?(n(),o("div",qo,[b.value.before.metadata.title?(n(),o("p",Jo,u(b.value.before.metadata.title),1)):v("",!0),b.value.before.metadata.description?(n(),o("p",Qo,u(b.value.before.metadata.description),1)):v("",!0),b.value.before.metadata.category?(n(),o("div",Xo,[e("span",Zo,u(b.value.before.metadata.category),1)])):v("",!0)])):v("",!0)])):v("",!0),b.value.after?(n(),o("div",en,[a[18]||(a[18]=e("div",{class:"hook-name"},[e("span",{class:"name-text"},"after"),e("span",{class:"hook-type"},"后置钩子")],-1)),S.value==="simple"&&b.value.after.metadata?(n(),o("div",tn,[b.value.after.metadata.title?(n(),o("p",sn,u(b.value.after.metadata.title),1)):v("",!0),b.value.after.metadata.description?(n(),o("p",an,u(b.value.after.metadata.description),1)):v("",!0),b.value.after.metadata.category?(n(),o("div",on,[e("span",nn,u(b.value.after.metadata.category),1)])):v("",!0)])):v("",!0)])):v("",!0)])])])):(n(),o("div",ln,[...a[19]||(a[19]=[e("div",{class:"empty-icon"},"📋",-1),e("p",null,"请选择配置项以查看预览",-1)])]))]),e("div",rn,[e("button",{class:"btn btn-primary",disabled:!$.value,onClick:x},[...a[20]||(a[20]=[e("span",{class:"btn-icon"},"📥",-1),ae(" 导出配置 ",-1)])],8,cn),e("button",{class:"btn btn-secondary",onClick:de},[...a[21]||(a[21]=[e("span",{class:"btn-icon"},"💾",-1),ae(" 保存配置 ",-1)])]),e("button",{class:"btn btn-secondary",onClick:g},[...a[22]||(a[22]=[e("span",{class:"btn-icon"},"🔄",-1),ae(" 重置选择 ",-1)])])])])])]),we(Us,{show:I.value,"onUpdate:show":a[5]||(a[5]=t=>I.value=t),onSave:le,onLoad:fe},null,8,["show"])]))}});const fn=$e(dn,[["__scopeId","data-v-4ba98cd9"]]);export{fn as default};
