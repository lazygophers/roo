var Le=Object.defineProperty;var Ue=(d,l,r)=>l in d?Le(d,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[l]=r;var he=(d,l,r)=>(Ue(d,typeof l!="symbol"?l+"":l,r),r);import{d as $e,r as S,f as Ce,g as Ae,h as De,c as o,a as e,w as J,v as ye,b as me,i as te,e as v,n as K,F as Y,j as G,k as we,l as Be,T as Ve,m as se,t as u,o as n,p as _e,q as Ke,s as Pe,u as P,x as je,y as Re,_ as Ye}from"./index-d353c5da.js";import{_ as Ee,a as ie}from"./_plugin-vue_export-helper-84a459c9.js";var Ge=typeof global=="object"&&global&&global.Object===Object&&global;const He=Ge;var qe=typeof self=="object"&&self&&self.Object===Object&&self,ze=He||qe||Function("return this")();const Me=ze;var We=Me.Symbol;const ke=We;var Fe=Object.prototype,Je=Fe.hasOwnProperty,Qe=Fe.toString,ge=ke?ke.toStringTag:void 0;function Xe(d){var l=Je.call(d,ge),r=d[ge];try{d[ge]=void 0;var g=!0}catch{}var c=Qe.call(d);return g&&(l?d[ge]=r:delete d[ge]),c}var Ze=Object.prototype,et=Ze.toString;function tt(d){return et.call(d)}var st="[object Null]",at="[object Undefined]",Oe=ke?ke.toStringTag:void 0;function ot(d){return d==null?d===void 0?at:st:Oe&&Oe in Object(d)?Xe(d):tt(d)}function nt(d){return d!=null&&typeof d=="object"}var lt="[object Symbol]";function it(d){return typeof d=="symbol"||nt(d)&&ot(d)==lt}var rt=/\s/;function ct(d){for(var l=d.length;l--&&rt.test(d.charAt(l)););return l}var ut=/^\s+/;function dt(d){return d&&d.slice(0,ct(d)+1).replace(ut,"")}function Se(d){var l=typeof d;return d!=null&&(l=="object"||l=="function")}var Ie=0/0,vt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,gt=/^0o[0-7]+$/i,pt=parseInt;function Te(d){if(typeof d=="number")return d;if(it(d))return Ie;if(Se(d)){var l=typeof d.valueOf=="function"?d.valueOf():d;d=Se(l)?l+"":l}if(typeof d!="string")return d===0?d:+d;d=dt(d);var r=ht.test(d);return r||gt.test(d)?pt(d.slice(2),r?2:8):vt.test(d)?Ie:+d}var ft=function(){return Me.Date.now()};const be=ft;var mt="Expected a function",_t=Math.max,yt=Math.min;function kt(d,l,r){var g,c,m,p,k,b,C=0,T=!1,f=!1,F=!0;if(typeof d!="function")throw new TypeError(mt);l=Te(l)||0,Se(r)&&(T=!!r.leading,f="maxWait"in r,m=f?_t(Te(r.maxWait)||0,l):m,F="trailing"in r?!!r.trailing:F);function x(I){var L=g,V=c;return g=c=void 0,C=I,p=d.apply(V,L),p}function O(I){return C=I,k=setTimeout(w,l),T?x(I):p}function A(I){var L=I-b,V=I-C,Q=l-L;return f?yt(Q,m-V):Q}function M(I){var L=I-b,V=I-C;return b===void 0||L>=l||L<0||f&&V>=m}function w(){var I=be();if(M(I))return $(I);k=setTimeout(w,A(I))}function $(I){return k=void 0,F&&g?x(I):(g=c=void 0,p)}function D(){k!==void 0&&clearTimeout(k),C=0,g=b=c=k=void 0}function B(){return k===void 0?p:$(be())}function N(){var I=be(),L=M(I);if(g=arguments,c=this,b=I,L){if(k===void 0)return O(b);if(f)return clearTimeout(k),k=setTimeout(w,l),x(b)}return k===void 0&&(k=setTimeout(w,l)),p}return N.cancel=D,N.flush=B,N}const bt={class:"search-filter"},Ct={class:"search-container"},wt={class:"search-input-wrapper"},St=["placeholder","onKeydown"],$t={key:0,class:"search-history"},Et=["onClick","onMouseenter"],xt={class:"history-text"},Rt=["onClick"],Ot={key:1,class:"search-suggestions"},It=["onClick","onMouseenter"],Tt={class:"suggestion-text"},At={key:0,class:"filter-panel"},jt={class:"filter-section"},Mt={class:"filter-options"},Ft=["value"],Nt={class:"filter-section"},Lt={class:"filter-options"},Ut={class:"filter-option"},Dt={class:"filter-option"},Bt={class:"filter-option"},Vt={class:"filter-section"},Kt={key:0,class:"quick-filters"},Pt=["onClick"],Yt={key:1,class:"search-stats"},Gt={class:"stats-text"},Ht={key:0,class:"search-time"},pe="config-search-history",qt=$e({__name:"SearchFilter",props:{modelValue:{},placeholder:{default:"搜索..."},searchScopes:{default:()=>[{value:"models",label:"Models"},{value:"rules",label:"Rules"},{value:"roles",label:"Roles"},{value:"commands",label:"Commands"}]},quickFilters:{default:()=>[]},maxHistory:{default:10}},emits:["update:modelValue","search","clear"],setup(d,{expose:l,emit:r}){const g=d,c=r,m=S(g.modelValue||""),p=S(null),k=S(!1),b=S(!1),C=S(!1),T=S(!1),f=S(-1),F=S(!1),x=S([]),O=S([]),A=S(g.searchScopes.map(h=>h.value)),M=S([]),w=S("relevance"),$=S({caseSensitive:!1,wholeWord:!1,highlightMatches:!0}),D=S(0),B=S(0),N=kt(h=>{if(h.trim()){const s=performance.now();c("search",h,{scopes:A.value,caseSensitive:$.value.caseSensitive,wholeWord:$.value.wholeWord,highlightMatches:$.value.highlightMatches,sortBy:w.value}),B.value=Math.round(performance.now()-s),T.value=!0}},300),I=()=>{c("update:modelValue",m.value),m.value?(k.value=!1,N(m.value),L()):(b.value=!1,c("clear"))},L=()=>{const h=[];if(m.value.length>2){const s=x.value.filter(i=>i.toLowerCase().includes(m.value.toLowerCase()));h.push(...s.slice(0,2));const t=["code","debug","architect","brain","hook","before","after"].filter(i=>i.toLowerCase().includes(m.value.toLowerCase()));h.push(...t.slice(0,3-h.length))}O.value=[...new Set(h)].slice(0,5),b.value=h.length>0},V=()=>{m.value="",c("update:modelValue",""),c("clear"),k.value=!1,b.value=!1,T.value=!1,f.value=-1,p.value&&p.value.focus()},Q=()=>{C.value=!C.value},X=()=>{F.value=!0,m.value||(k.value=!0,f.value=-1)},de=()=>{F.value=!1,setTimeout(()=>{F.value||(k.value=!1,b.value=!1)},200)},q=()=>{m.value&&N(m.value)},ae=h=>{const s=M.value.indexOf(h);s>-1?M.value.splice(s,1):M.value.push(h),m.value&&N(m.value)},Z=h=>{m.value=h,c("update:modelValue",h),k.value=!1,N(h),ne(h)},oe=h=>{m.value=h,c("update:modelValue",h),b.value=!1,N(h),ne(h)},ne=h=>{const s=h.trim();if(!s)return;const a=x.value.indexOf(s);a>-1&&x.value.splice(a,1),x.value.unshift(s),x.value.length>g.maxHistory&&(x.value=x.value.slice(0,g.maxHistory)),localStorage.setItem(pe,JSON.stringify(x.value))},y=h=>{x.value.splice(h,1),localStorage.setItem(pe,JSON.stringify(x.value)),x.value.length===0&&(k.value=!1)},_=()=>{x.value=[],localStorage.removeItem(pe),k.value=!1},E=()=>{const h=k.value?x.value:O.value;h.length>0&&(f.value=(f.value+1)%h.length)},z=()=>{const h=k.value?x.value:O.value;h.length>0&&(f.value=f.value<=0?h.length-1:f.value-1)},W=()=>{const h=k.value?x.value:O.value;f.value>=0&&f.value<h.length&&(k.value?Z(h[f.value]):oe(h[f.value]))};Ce(x,h=>{localStorage.setItem(pe,JSON.stringify(h))}),Ce(()=>g.modelValue,h=>{h!==m.value&&(m.value=h||"")}),l({setSearchResults:h=>{D.value=h},resetFilters:()=>{A.value=g.searchScopes.map(h=>h.value),M.value=[],$.value={caseSensitive:!1,wholeWord:!1,highlightMatches:!0},w.value="relevance"}}),Ae(()=>{try{const h=localStorage.getItem(pe);h&&(x.value=JSON.parse(h))}catch(h){console.error("Failed to load search history:",h)}document.addEventListener("keydown",fe)}),De(()=>{document.removeEventListener("keydown",fe)});const fe=h=>{var s;(h.metaKey||h.ctrlKey)&&h.key==="k"&&(h.preventDefault(),(s=p.value)==null||s.focus()),h.key==="Escape"&&(C.value?C.value=!1:k.value||b.value?(k.value=!1,b.value=!1):V())};return(h,s)=>(n(),o("div",bt,[e("div",Ct,[e("div",wt,[s[6]||(s[6]=e("div",{class:"search-icon"},"🔍",-1)),J(e("input",{ref_key:"searchInput",ref:p,"onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a),type:"text",placeholder:h.placeholder,onInput:I,onFocus:X,onBlur:de,onKeydown:[me(te(E,["prevent"]),["down"]),me(te(z,["prevent"]),["up"]),me(te(W,["prevent"]),["enter"]),me(te(V,["prevent"]),["esc"])]},null,40,St),[[ye,m.value]]),m.value?(n(),o("button",{key:0,class:"clear-btn",onClick:V,title:"清除搜索"}," ✕ ")):v("",!0),e("button",{class:K(["filter-toggle",{active:C.value}]),onClick:Q,title:"筛选选项"}," ⚙️ ",2)]),k.value&&x.value.length>0&&!m.value?(n(),o("div",$t,[e("div",{class:"history-header"},[s[7]||(s[7]=e("span",null,"搜索历史",-1)),e("button",{class:"clear-history",onClick:_,title:"清除历史"}," 清除 ")]),(n(!0),o(Y,null,G(x.value,(a,t)=>(n(),o("div",{key:t,class:K(["history-item",{highlighted:f.value===t}]),onClick:i=>Z(a),onMouseenter:i=>f.value=t},[s[8]||(s[8]=e("span",{class:"history-icon"},"🕐",-1)),e("span",xt,u(a),1),e("button",{class:"remove-history",onClick:te(i=>y(t),["stop"]),title:"移除"}," ✕ ",8,Rt)],42,Et))),128))])):v("",!0),b.value&&O.value.length>0?(n(),o("div",Ot,[(n(!0),o(Y,null,G(O.value,(a,t)=>(n(),o("div",{key:t,class:K(["suggestion-item",{highlighted:f.value===t}]),onClick:i=>oe(a),onMouseenter:i=>f.value=t},[s[9]||(s[9]=e("span",{class:"suggestion-icon"},"💡",-1)),e("span",Tt,u(a),1)],42,It))),128))])):v("",!0),we(Ve,{name:"slide-down"},{default:Be(()=>[C.value?(n(),o("div",At,[e("div",jt,[s[10]||(s[10]=e("h3",null,"搜索范围",-1)),e("div",Mt,[(n(!0),o(Y,null,G(h.searchScopes,a=>(n(),o("label",{key:a.value,class:"filter-option"},[J(e("input",{type:"checkbox",value:a.value,"onUpdate:modelValue":s[1]||(s[1]=t=>A.value=t),onChange:q},null,40,Ft),[[_e,A.value]]),e("span",null,u(a.label),1)]))),128))])]),e("div",Nt,[s[14]||(s[14]=e("h3",null,"搜索选项",-1)),e("div",Lt,[e("label",Ut,[J(e("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=a=>$.value.caseSensitive=a),onChange:q},null,544),[[_e,$.value.caseSensitive]]),s[11]||(s[11]=e("span",null,"区分大小写",-1))]),e("label",Dt,[J(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=a=>$.value.wholeWord=a),onChange:q},null,544),[[_e,$.value.wholeWord]]),s[12]||(s[12]=e("span",null,"全词匹配",-1))]),e("label",Bt,[J(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=a=>$.value.highlightMatches=a),onChange:q},null,544),[[_e,$.value.highlightMatches]]),s[13]||(s[13]=e("span",null,"高亮匹配",-1))])])]),e("div",Vt,[s[16]||(s[16]=e("h3",null,"排序方式",-1)),J(e("select",{"onUpdate:modelValue":s[5]||(s[5]=a=>w.value=a),onChange:q,class:"sort-select"},[...s[15]||(s[15]=[e("option",{value:"relevance"},"相关度",-1),e("option",{value:"name"},"名称",-1),e("option",{value:"category"},"类别",-1),e("option",{value:"modified"},"修改时间",-1)])],544),[[Ke,w.value]])])])):v("",!0)]),_:1})]),h.quickFilters.length>0?(n(),o("div",Kt,[s[17]||(s[17]=e("span",{class:"quick-filter-label"},"快速筛选:",-1)),(n(!0),o(Y,null,G(h.quickFilters,a=>(n(),o("button",{key:a.value,class:K(["quick-filter-tag",{active:M.value.includes(a.value)}]),onClick:t=>ae(a.value)},u(a.label),11,Pt))),128))])):v("",!0),T.value&&m.value?(n(),o("div",Yt,[e("span",Gt,[s[18]||(s[18]=se(" 找到 ",-1)),e("strong",null,u(D.value),1),s[19]||(s[19]=se(" 个结果 ",-1)),B.value?(n(),o("span",Ht," ("+u(B.value)+"ms) ",1)):v("",!0)])])):v("",!0)]))}});const zt=Ee(qt,[["__scopeId","data-v-e8bbc804"]]);class Wt{constructor(){he(this,"STORAGE_KEY","roo-configs");he(this,"VERSION_KEY","roo-configs-version");he(this,"BACKUP_KEY","roo-configs-backup");he(this,"CURRENT_VERSION","1.0.0")}async initialize(){const l=localStorage.getItem(this.VERSION_KEY);l?l!==this.CURRENT_VERSION&&await this.migrateData(l,this.CURRENT_VERSION):await this.createBackup(),localStorage.setItem(this.VERSION_KEY,this.CURRENT_VERSION)}async saveConfig(l,r,g){try{const c=await this.getAllConfigs(),m={id:this.generateId(),name:l,description:g||"",config:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:this.CURRENT_VERSION},p=c.findIndex(b=>b.name===l);p>=0?c[p]={...c[p],config:r,description:g||c[p].description,updatedAt:new Date().toISOString()}:c.push(m);const k=this.compressData(c);localStorage.setItem(this.STORAGE_KEY,k),await this.createBackup()}catch(c){throw console.error("Failed to save config:",c),new Error("保存配置失败")}}async getAllConfigs(){try{const l=localStorage.getItem(this.STORAGE_KEY);return l?this.decompressData(l)||[]:[]}catch(l){throw console.error("Failed to load configs:",l),new Error("加载配置失败")}}async loadConfig(l){try{const g=(await this.getAllConfigs()).find(c=>c.id===l);return g?g.config:null}catch(r){throw console.error("Failed to load config:",r),new Error("加载配置失败")}}async deleteConfig(l){try{const g=(await this.getAllConfigs()).filter(m=>m.id!==l),c=this.compressData(g);localStorage.setItem(this.STORAGE_KEY,c),await this.createBackup()}catch(r){throw console.error("Failed to delete config:",r),new Error("删除配置失败")}}async renameConfig(l,r){try{const g=await this.getAllConfigs(),c=g.find(p=>p.id===l);if(!c)throw new Error("配置不存在");c.name=r,c.updatedAt=new Date().toISOString();const m=this.compressData(g);localStorage.setItem(this.STORAGE_KEY,m)}catch(g){throw console.error("Failed to rename config:",g),new Error("重命名配置失败")}}async exportConfig(l){try{const g=(await this.getAllConfigs()).find(k=>k.id===l);if(!g)throw new Error("配置不存在");const c=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),m=URL.createObjectURL(c),p=document.createElement("a");p.href=m,p.download=`config-${g.name}-${Date.now()}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(m)}catch(r){throw console.error("Failed to export config:",r),new Error("导出配置失败")}}async importConfig(l){try{const r=await l.text(),g=JSON.parse(r);if(!this.validateConfig(g))throw new Error("配置格式无效");g.id=this.generateId(),g.updatedAt=new Date().toISOString();const c=await this.getAllConfigs();c.push(g);const m=this.compressData(c);localStorage.setItem(this.STORAGE_KEY,m),await this.createBackup()}catch(r){throw console.error("Failed to import config:",r),new Error("导入配置失败")}}async createBackup(){try{const l=localStorage.getItem(this.STORAGE_KEY);l&&(localStorage.setItem(this.BACKUP_KEY,l),localStorage.setItem(`${this.BACKUP_KEY}-timestamp`,Date.now().toString()))}catch(l){console.error("Failed to create backup:",l)}}async restoreBackup(){try{const l=localStorage.getItem(this.BACKUP_KEY);return l?(localStorage.setItem(this.STORAGE_KEY,l),!0):!1}catch(l){throw console.error("Failed to restore backup:",l),new Error("恢复备份失败")}}compressData(l){try{const r=JSON.stringify(l);return btoa(unescape(encodeURIComponent(r)))}catch(r){return console.error("Compression failed:",r),JSON.stringify(l)}}decompressData(l){try{const r=decodeURIComponent(escape(atob(l)));return JSON.parse(r)}catch(r){try{return JSON.parse(l)}catch{return console.error("Decompression failed:",r),null}}}async migrateData(l,r){console.log(`Migrating from ${l} to ${r}`),await this.createBackup()}validateConfig(l){return l&&typeof l.id=="string"&&typeof l.name=="string"&&typeof l.config=="object"&&Array.isArray(l.config.models)&&typeof l.config.rules=="object"}generateId(){return`config_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async getStorageStats(){const l=await this.getAllConfigs(),r=localStorage.getItem(this.STORAGE_KEY),g=localStorage.getItem(`${this.BACKUP_KEY}-timestamp`);return{totalConfigs:l.length,totalSize:r?new Blob([r]).size:0,lastBackup:g?new Date(parseInt(g)):void 0}}}const H=new Wt,Ne=Pe("config",()=>{const d=S([]),l=S(!1),r=S(null),g=S({totalConfigs:0,totalSize:0}),c=P(()=>d.value.length>0),m=P(()=>[...d.value].sort((w,$)=>new Date($.updatedAt).getTime()-new Date(w.updatedAt).getTime())),p=async()=>{try{l.value=!0,await H.initialize(),await k(),await A()}catch(w){r.value=w instanceof Error?w.message:"初始化失败"}finally{l.value=!1}},k=async()=>{try{l.value=!0,r.value=null,d.value=await H.getAllConfigs()}catch(w){throw r.value=w instanceof Error?w.message:"加载配置失败",w}finally{l.value=!1}},b=async(w,$,D)=>{try{return l.value=!0,r.value=null,await H.saveConfig(w,$,D),await k(),await A(),!0}catch(B){throw r.value=B instanceof Error?B.message:"保存配置失败",B}finally{l.value=!1}},C=async w=>{try{return l.value=!0,r.value=null,await H.loadConfig(w)}catch($){throw r.value=$ instanceof Error?$.message:"加载配置失败",$}finally{l.value=!1}},T=async w=>{try{l.value=!0,r.value=null,await H.deleteConfig(w),await k(),await A()}catch($){throw r.value=$ instanceof Error?$.message:"删除配置失败",$}finally{l.value=!1}},f=async(w,$)=>{try{l.value=!0,r.value=null,await H.renameConfig(w,$),await k()}catch(D){throw r.value=D instanceof Error?D.message:"重命名配置失败",D}finally{l.value=!1}},F=async w=>{try{await H.exportConfig(w)}catch($){throw r.value=$ instanceof Error?$.message:"导出配置失败",$}},x=async w=>{try{l.value=!0,r.value=null,await H.importConfig(w),await k(),await A()}catch($){throw r.value=$ instanceof Error?$.message:"导入配置失败",$}finally{l.value=!1}},O=async()=>{try{l.value=!0,r.value=null;const w=await H.restoreBackup();return w&&(await k(),await A()),w}catch(w){throw r.value=w instanceof Error?w.message:"恢复备份失败",w}finally{l.value=!1}},A=async()=>{try{g.value=await H.getStorageStats()}catch(w){console.error("Failed to update storage stats:",w)}};return{savedConfigs:d,isLoading:l,error:r,storageStats:g,hasConfigs:c,sortedConfigs:m,initialize:p,loadConfigs:k,saveConfig:b,loadConfig:C,deleteConfig:T,renameConfig:f,exportConfig:F,importConfig:x,restoreBackup:O,updateStorageStats:A,clearError:()=>{r.value=null}}}),Jt=Object.freeze(Object.defineProperty({__proto__:null,useConfigStore:Ne},Symbol.toStringTag,{value:"Module"})),Qt={key:0,class:"config-manager"},Xt={class:"modal-content"},Zt={class:"modal-header"},es={key:0,class:"config-form"},ts={class:"form-group"},ss={key:0,class:"error-message"},as={class:"form-group"},os={class:"form-actions"},ns=["disabled"],ls={key:1,class:"config-list"},is={key:0,class:"loading"},rs={key:1,class:"empty-state"},cs={key:2,class:"configs-container"},us={class:"toolbar"},ds={class:"toolbar-info"},vs={class:"config-count"},hs={class:"storage-size"},gs={class:"toolbar-actions"},ps=["disabled"],fs=["disabled"],ms={class:"configs-grid"},_s={class:"config-card-header"},ys={class:"config-info"},ks={key:0,class:"description"},bs={class:"meta"},Cs={class:"date"},ws={key:0,class:"date"},Ss={class:"config-card-content"},$s={class:"config-preview"},Es={class:"preview-item"},xs={class:"value"},Rs={class:"preview-item"},Os={class:"value"},Is={class:"preview-item"},Ts={class:"value"},As={class:"config-actions"},js=["onClick"],Ms=["onClick"],Fs=["onClick"],Ns=["onClick"],Ls=["onClick"],Us=$e({__name:"ConfigManager",props:{show:{type:Boolean,default:!1},initialMode:{default:"list"},currentConfig:{default:void 0}},emits:["update:show","apply","close"],setup(d,{emit:l}){const r=d,g=l,c=Ne(),m=S(r.initialMode),p=S(""),k=S(""),b=S(!1),C=S({}),T=S(),f=P(()=>c.savedConfigs),F=P(()=>c.sortedConfigs),x=P(()=>c.hasConfigs),O=P(()=>c.storageStats),A=()=>{g("update:show",!1),ae()},M=y=>{m.value=y,y==="save"&&je(()=>{const _=document.querySelector('input[type="text"]');_==null||_.focus()})},w=()=>p.value.trim()?f.value.find(_=>_.name===p.value.trim())?(C.value.name="配置名称已存在",!1):(delete C.value.name,!0):(C.value.name="配置名称不能为空",!1),$=async()=>{if(!(!w()||!r.currentConfig))try{b.value=!0,await c.saveConfig(p.value.trim(),r.currentConfig,k.value.trim()||void 0),m.value="list",ae()}catch(y){console.error("Save failed:",y)}finally{b.value=!1}},D=y=>{g("apply",y.config),A()},B=y=>{console.log("Load config details:",y)},N=async y=>{try{await c.exportConfig(y)}catch(_){console.error("Export failed:",_)}},I=async y=>{const _=prompt("请输入新的配置名称:",y.name);if(_&&_.trim()&&_.trim()!==y.name)try{await c.renameConfig(y.id,_.trim())}catch(E){console.error("Rename failed:",E)}},L=async y=>{if(confirm(`确定要删除配置 "${y.name}" 吗？此操作不可恢复。`))try{await c.deleteConfig(y.id)}catch(_){console.error("Delete failed:",_)}},V=async()=>{try{b.value=!0,await c.loadConfigs(),await c.updateStorageStats()}catch(y){console.error("Refresh failed:",y)}finally{b.value=!1}},Q=()=>{var y;(y=T.value)==null||y.click()},X=async y=>{var z;const _=y.target,E=(z=_.files)==null?void 0:z[0];if(E)try{b.value=!0,await c.importConfig(E)}catch(W){console.error("Import failed:",W)}finally{b.value=!1,_.value=""}},de=()=>{const y=new Blob([JSON.stringify(f.value,null,2)],{type:"application/json"}),_=URL.createObjectURL(y),E=document.createElement("a");E.href=_,E.download=`all-configs-${Date.now()}.json`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(_)},q=async()=>{if(confirm("确定要恢复到最近的备份吗？这将覆盖当前的配置。"))try{const y=await c.restoreBackup();alert(y?"备份恢复成功！":"没有找到可用的备份")}catch(y){console.error("Restore backup failed:",y),alert("恢复备份失败")}},ae=()=>{p.value="",k.value="",C.value={}},Z=y=>new Date(y).toLocaleDateString("zh-CN"),oe=y=>y<1024?y+" B":y<1024*1024?(y/1024).toFixed(1)+" KB":(y/(1024*1024)).toFixed(1)+" MB",ne=P(()=>m.value==="save"?"保存配置":"我的配置");return Ce(()=>r.show,y=>{y&&(m.value=r.initialMode,ae(),c.clearError())}),(y,_)=>y.show?(n(),o("div",Qt,[e("div",{class:"modal-backdrop",onClick:A}),e("div",Xt,[e("div",Zt,[e("h2",null,u(ne.value),1),e("button",{class:"close-btn",onClick:A},"✕")]),m.value==="save"?(n(),o("div",es,[e("div",ts,[_[4]||(_[4]=e("label",null,[se("配置名称 "),e("span",{class:"required"},"*")],-1)),J(e("input",{"onUpdate:modelValue":_[0]||(_[0]=E=>p.value=E),type:"text",placeholder:"输入配置名称...",class:K({error:C.value.name}),onInput:w},null,34),[[ye,p.value]]),C.value.name?(n(),o("span",ss,u(C.value.name),1)):v("",!0)]),e("div",as,[_[5]||(_[5]=e("label",null,"描述（可选）",-1)),J(e("textarea",{"onUpdate:modelValue":_[1]||(_[1]=E=>k.value=E),placeholder:"添加配置描述...",rows:"3"},null,512),[[ye,k.value]])]),e("div",os,[e("button",{class:"btn btn-primary",disabled:!p.value.trim()||b.value,onClick:$},u(b.value?"保存中...":"保存配置"),9,ns),e("button",{class:"btn btn-secondary",onClick:A},"取消")])])):m.value==="list"?(n(),o("div",ls,[b.value?(n(),o("div",is,[..._[6]||(_[6]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"加载中...",-1)])])):x.value?(n(),o("div",cs,[e("div",us,[e("div",ds,[e("span",vs,u(f.value.length)+" 个配置",1),e("span",hs,"占用空间: "+u(oe(O.value.totalSize)),1)]),e("div",gs,[e("button",{class:"btn-icon",title:"刷新",onClick:V,disabled:b.value}," 🔄 ",8,ps),e("button",{class:"btn-icon",title:"导入配置",onClick:Q}," 📥 "),e("button",{class:"btn-icon",title:"导出所有",onClick:de}," 📤 "),e("button",{class:"btn-icon",title:"恢复备份",onClick:q,disabled:b.value}," 💾 ",8,fs),e("button",{class:"btn-icon btn-primary",title:"创建新配置",onClick:_[3]||(_[3]=E=>M("save"))}," ➕ ")])]),e("div",ms,[(n(!0),o(Y,null,G(F.value,E=>{var z,W,ve;return n(),o("div",{key:E.id,class:"config-card"},[e("div",_s,[e("div",ys,[e("h3",null,u(E.name),1),E.description?(n(),o("p",ks,u(E.description),1)):v("",!0),e("div",bs,[e("span",Cs,"创建于: "+u(Z(E.createdAt)),1),E.updatedAt!==E.createdAt?(n(),o("span",ws," 更新于: "+u(Z(E.updatedAt)),1)):v("",!0)])])]),e("div",Ss,[e("div",$s,[e("div",Es,[_[9]||(_[9]=e("span",{class:"label"},"Models:",-1)),e("span",xs,u(((z=E.config.models)==null?void 0:z.length)||0)+" 个",1)]),e("div",Rs,[_[10]||(_[10]=e("span",{class:"label"},"Roles:",-1)),e("span",Os,u(((W=E.config.roles)==null?void 0:W.length)||0)+" 个",1)]),e("div",Is,[_[11]||(_[11]=e("span",{class:"label"},"Commands:",-1)),e("span",Ts,u(((ve=E.config.commands)==null?void 0:ve.length)||0)+" 个",1)])]),e("div",As,[e("button",{class:"btn-sm btn-primary",onClick:le=>D(E),title:"应用此配置"}," 应用 ",8,js),e("button",{class:"btn-sm btn-secondary",onClick:le=>B(E),title:"查看详情"}," 详情 ",8,Ms),e("button",{class:"btn-sm",onClick:le=>N(E.id),title:"导出配置"}," 📤 ",8,Fs),e("button",{class:"btn-sm",onClick:le=>I(E),title:"重命名"}," ✏️ ",8,Ns),e("button",{class:"btn-sm btn-danger",onClick:le=>L(E),title:"删除配置"}," 🗑️ ",8,Ls)])])])}),128))])])):(n(),o("div",rs,[_[7]||(_[7]=e("div",{class:"empty-icon"},"📁",-1)),_[8]||(_[8]=e("p",null,"暂无保存的配置",-1)),e("button",{class:"btn btn-primary",onClick:_[2]||(_[2]=E=>M("save"))}," 创建新配置 ")]))])):v("",!0)]),e("input",{ref_key:"fileInput",ref:T,type:"file",accept:".json",style:{display:"none"},onChange:X},null,544)])):v("",!0)}});const Ds=Ee(Us,[["__scopeId","data-v-b7c5d379"]]);const Bs={class:"config-selector"},Vs={class:"container"},Ks={class:"global-search-section"},Ps={class:"config-layout"},Ys={class:"selection-panel"},Gs={class:"config-section"},Hs={class:"search-box"},qs={class:"items-list"},zs=["onClick"],Ws={class:"item-header"},Js=["checked","onChange","disabled","title"],Qs={class:"item-info"},Xs={class:"text-primary"},Zs={key:0,class:"required-crown",title:"必选项"},ea={class:"slug text-secondary"},ta={key:0,class:"description text-secondary"},sa={key:1,class:"meta"},aa={class:"category text-inverted"},oa={key:0,class:"tags text-secondary"},na={key:2,class:"model-rules"},la={class:"model-rules-header"},ia={class:"model-rules-actions"},ra=["onClick","title"],ca={class:"model-rules-list"},ua=["onClick"],da={class:"rule-header"},va=["checked","onChange","disabled"],ha={class:"rule-info"},ga={class:"text-primary"},pa={key:0,class:"rule-preview"},fa={key:0,class:"rule-metadata-simple"},ma={key:0,class:"rule-title"},_a={key:1,class:"rule-description"},ya={key:2,class:"rule-meta-info"},ka={key:0,class:"category-tag"},ba={key:1,class:"tags"},Ca={key:1,class:"rule-content-preview"},wa={key:0,class:"rule-metadata-header"},Sa={key:0,class:"meta-description"},$a={key:1},Ea={class:"config-section"},xa={class:"items-list"},Ra=["onClick"],Oa={class:"item-header"},Ia=["checked","onChange"],Ta={class:"item-info"},Aa={class:"text-primary"},ja={key:0,class:"role-preview"},Ma={key:0,class:"role-metadata-simple"},Fa={key:0,class:"role-title"},Na={key:1,class:"role-description"},La={key:2,class:"role-traits"},Ua={class:"traits-value"},Da={key:1,class:"role-content-preview"},Ba={key:0,class:"role-metadata-header"},Va={key:0,class:"meta-description"},Ka={key:1},Pa={class:"config-section"},Ya={class:"items-list"},Ga=["onClick"],Ha={class:"item-header"},qa=["checked","onChange"],za={class:"item-info"},Wa={class:"text-primary"},Ja={key:0,class:"command-preview"},Qa={key:0,class:"command-metadata-simple"},Xa={key:0,class:"command-title"},Za={key:1,class:"command-description"},eo={key:2,class:"command-meta-info"},to={key:0,class:"category-tag"},so={key:1,class:"tags"},ao={key:1,class:"command-content-preview"},oo={key:0,class:"command-metadata-header"},no={key:0,class:"meta-description"},lo={key:1},io={class:"preview-panel"},ro={class:"preview-section"},co={class:"preview-header"},uo={class:"preview-controls"},vo={class:"mode-toggle"},ho={key:0,class:"preview-content"},go={class:"preview-grid"},po={key:0,class:"preview-card"},fo={class:"card-header"},mo={class:"card-content"},_o={class:"model-name"},yo={class:"name-text"},ko={class:"slug-text"},bo={key:0,class:"model-metadata-simple"},Co={key:0,class:"meta-description"},wo={key:1,class:"model-meta-info"},So={key:0,class:"category-tag"},$o={key:1,class:"tags"},Eo={key:1,class:"rules-count"},xo={class:"count-badge"},Ro={key:1,class:"preview-card"},Oo={class:"card-content"},Io={class:"role-item"},To={class:"name-text"},Ao={key:0,class:"role-metadata-simple"},jo={key:0,class:"meta-description"},Mo={key:1,class:"role-traits"},Fo={class:"traits-value"},No={key:2,class:"preview-card"},Lo={class:"card-header"},Uo={class:"card-content"},Do={class:"commands-grid"},Bo={class:"command-name"},Vo={key:0,class:"command-metadata-simple"},Ko={key:0,class:"meta-description"},Po={key:1,class:"command-meta-info"},Yo={key:0,class:"category-tag"},Go={key:1,class:"preview-card"},Ho={class:"card-header"},qo={class:"card-content"},zo={class:"hooks-list"},Wo={key:0,class:"hook-item"},Jo={key:0,class:"hook-metadata-simple"},Qo={key:0,class:"meta-description"},Xo={key:1,class:"hook-description"},Zo={key:2,class:"hook-meta-info"},en={class:"category-tag"},tn={key:1,class:"hook-item"},sn={key:0,class:"hook-metadata-simple"},an={key:0,class:"meta-description"},on={key:1,class:"hook-description"},nn={key:2,class:"hook-meta-info"},ln={class:"category-tag"},rn={key:2,class:"empty-preview"},cn={class:"actions"},un=["disabled"],j="orchestrator",ue=100,dn=300,vn=$e({__name:"ConfigSelector",setup(d){const r=((s,a)=>{let t;return function(...i){clearTimeout(t),t=window.setTimeout(()=>s.apply(this,i),a)}})(()=>{},dn),g=S([]),c=S([]),m=S({}),p=S(null),k=S({}),b=S([]),C=S({before:"",after:""}),T=S({}),f=S({}),F=s=>{T.value[s]||(T.value[s]={}),f.value[s]||(f.value[s]=[])},x=S(""),O=S("detailed");S(!1);const A=S(null),M=S(!1),w=S("");S();const $=P(()=>c.value.length>0||Object.keys(f.value).length>0||p.value!==null||b.value.length>0),D=P(()=>c.value.length>0);P(()=>c.value.some(s=>s.slug===j)),P(()=>Object.values(f.value).reduce((s,a)=>s+a.length,0));const B=(s,a)=>{var t;return((t=f.value[s])==null?void 0:t.includes(a))||!1},N=s=>{const a=Object.keys(T.value[s]||{}),t=f.value[s]||[];return a.length>0&&a.every(i=>t.includes(i))},I=P(()=>{const s=x.value.toLowerCase(),a=g.value||[];return s?a.filter(t=>{var i,R,U;return t.name.toLowerCase().includes(s)||t.slug.toLowerCase().includes(s)||((i=t.description)==null?void 0:i.toLowerCase().includes(s))||((R=t.category)==null?void 0:R.toLowerCase().includes(s))||((U=t.tags)==null?void 0:U.some(ee=>ee.toLowerCase().includes(s)))}):a}),L=(s,a)=>{console.error(`Failed to ${a}:`,s),s.value=`${a} 失败`},V=()=>{A.value=null},Q=async()=>{var s;V();try{const a=await ie.post("/api/models");console.log("API Response from /api/models:",a),g.value=a||[],console.log("Models value after assignment:",g.value),console.log("Models length:",(s=g.value)==null?void 0:s.length);const t=(g.value||[]).find(i=>i.slug===j);console.log("Found orchestrator model:",t),t&&(console.log("Adding orchestrator to selected models"),c.value.push(t),console.log("Selected models after push:",c.value),await X(j))}catch(a){L(a,"fetch models")}},X=async s=>{V();try{const t=await ie.post(`/api/rules/${s}`)||{};F(s),T.value[s]=t,s===j?f.value[s]=Object.keys(t):f.value[s]=[]}catch(a){L(a,`fetch rules for ${s}`)}},de=async()=>{try{const s=await ie.post("/api/roles");m.value=s||{}}catch(s){console.error("Failed to fetch roles:",s)}},q=async()=>{try{const s=await ie.post("/api/commands");console.log(s),k.value=s||{}}catch(s){console.error("Failed to fetch commands:",s)}},ae=async()=>{try{const[s,a]=await Promise.all([ie.post("/api/hooks/before"),ie.post("/api/hooks/after")]);C.value={before:s||"",after:a||""}}catch(s){console.error("Failed to fetch hooks:",s)}},Z=async s=>{const a=c.value.findIndex(t=>t.slug===s.slug);if(a>-1){if(s.slug===j)return;c.value.splice(a,1),delete f.value[s.slug],delete T.value[s.slug]}else{c.value.push(s);try{const i=await ie.post(`/api/rules/${s.slug}`)||{};F(s.slug),T.value[s.slug]=i,s.slug===j?f.value[s.slug]=Object.keys(i):f.value[s.slug]=[]}catch(t){console.error(`Failed to fetch rules for ${s.slug}:`,t)}}},oe=(s,a)=>{var t;((t=p.value)==null?void 0:t.name)===s?p.value=null:p.value={name:s,content:a.content}},ne=(s,a)=>{const t=b.value.findIndex(i=>i.name===s);t>-1?b.value.splice(t,1):b.value.push({name:s,content:a.content})},y=(s,a,t)=>{if(s===j)return;F(s);const i=f.value[s].indexOf(a);i>-1?f.value[s].splice(i,1):f.value[s].push(a)},_=s=>{if(s===j)return;const a=Object.keys(T.value[s]||{});f.value[s],N(s)?f.value[s]=[]:f.value[s]=[...a]},E=()=>{const s=c.value.find(a=>a.slug===j);c.value=s?[s]:[],T.value={},f.value={},p.value=null,b.value=[],x.value="",s&&X(s.slug)},z=()=>{const s={models:c.value,rules:{},roles:p.value?[p.value]:[],commands:b.value,hooks:C.value};c.value.forEach(U=>{const ee=f.value[U.slug]||[];s.rules[U.slug]=ee.map(re=>{var xe;const ce=(xe=T.value[U.slug])==null?void 0:xe[re];return{name:re,content:(ce==null?void 0:ce.content)||""}})});const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),i=document.createElement("a");i.href=t;const R=c.value.map(U=>U.slug).join("-");i.download=`config-${R}-${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)};console.log("🎯 ConfigSelector 组件开始初始化"),Ae(async()=>{console.log("🚀 ConfigSelector 组件已挂载，开始获取数据");try{await Promise.all([Q(),de(),q(),ae()]),console.log("✅ 所有初始数据获取完成")}catch(s){console.error("❌ 初始数据获取失败:",s)}je(()=>{var s,a;if(console.log("🔄 nextTick 回调执行"),console.log("当前 models 长度:",(s=g.value||[])==null?void 0:s.length),console.log("当前 selectedModels:",c.value),(((a=g.value||[])==null?void 0:a.length)||0)>0&&!(c.value||[]).some(t=>t.slug===j)){console.log("准备自动选择 orchestrator");const t=(g.value||[]).find(i=>i.slug===j);t&&(console.log("添加 orchestrator 到已选择"),c.value.push(t),X(t.slug))}else console.log("orchestrator 已经存在或 models 为空")})});const W=(s,a)=>{w.value=s},ve=s=>{W(w.value)},le=()=>{M.value=!0},fe=async s=>{const a={models:c.value,rules:{},roles:p.value?[p.value]:[],commands:b.value,hooks:C.value};c.value.forEach(R=>{const U=f.value[R.slug]||[];a.rules[R.slug]=U.map(ee=>{var ce;const re=(ce=T.value[R.slug])==null?void 0:ce[ee];return{name:ee,content:(re==null?void 0:re.content)||""}})});const{useConfigStore:t}=await Ye(()=>Promise.resolve().then(()=>Jt),void 0),i=t();try{await i.saveConfig(s,a)}catch(R){console.error("保存配置失败:",R)}},h=async s=>{if(E(),s.models&&Array.isArray(s.models)){c.value=s.models;for(const a of s.models)await X(a.slug),s.rules&&s.rules[a.slug]&&(f.value[a.slug]=s.rules[a.slug].map(t=>t.name))}if(s.roles&&s.roles.length>0){const a=s.roles[0];p.value=a}s.commands&&Array.isArray(s.commands)&&(b.value=s.commands)};return(s,a)=>(n(),o("div",Bs,[e("div",Vs,[a[23]||(a[23]=e("div",{class:"header"},[e("h1",null,"配置选择器"),e("p",{class:"description"},"选择您需要的 models、rules、roles 和 commands")],-1)),e("div",Ks,[we(zt,{"initial-query":w.value,placeholder:"搜索 modes, rules, roles, commands...",scopes:[{value:"all",label:"全部"},{value:"models",label:"Modes"},{value:"rules",label:"Rules"},{value:"roles",label:"Roles"},{value:"commands",label:"Commands"}],"quick-filters":[{value:"selected",label:"已选择"},{value:"recent",label:"最近更新"}],onSearch:W,onFilterChange:ve},null,8,["initial-query"])]),e("div",Ps,[e("div",Ys,[e("div",Gs,[a[7]||(a[7]=e("h2",null,[se("模式 "),e("span",{class:"required"},"*")],-1)),e("div",Hs,[a[6]||(a[6]=e("div",{class:"search-icon"},"🔍",-1)),J(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>x.value=t),type:"text",placeholder:"搜索模式...",onInput:a[1]||(a[1]=(...t)=>Re(r)&&Re(r)(...t))},null,544),[[ye,x.value]]),x.value?(n(),o("button",{key:0,class:"clear-btn",onClick:a[2]||(a[2]=t=>{x.value=""})}," ✕ ")):v("",!0)]),e("div",qs,[(n(!0),o(Y,null,G(I.value,t=>(n(),o("div",{key:t.slug,class:K(["item-card",{selected:c.value.some(i=>i.slug===t.slug)}]),onClick:i=>Z(t)},[e("div",Ws,[e("input",{type:"checkbox",checked:c.value.some(i=>i.slug===t.slug),onChange:i=>Z(t),disabled:t.slug===j,title:t.slug===j?"Orchestrator模式为必选项，不可取消":"",class:K(["custom-checkbox",{"required-checkbox":t.slug===j}])},null,42,Js),e("div",Qs,[e("h3",Xs,[se(u(t.name)+" ",1),t.slug===j?(n(),o("span",Zs,"👑")):v("",!0)]),e("p",ea,u(t.slug),1)])]),t.description?(n(),o("p",ta,u(t.description),1)):v("",!0),t.category?(n(),o("div",sa,[e("span",aa,u(t.category),1),t.tags?(n(),o("span",oa,u(t.tags.join(", ")),1)):v("",!0)])):v("",!0),c.value.some(i=>i.slug===t.slug)&&T.value[t.slug]?(n(),o("div",na,[e("div",la,[e("h4",null,u(t.name)+" 的规则",1),e("div",ia,[e("button",{class:"action-btn",onClick:te(i=>_(t.slug),["stop"]),title:N(t.slug)?"取消全选":"全选"},u(N(t.slug)?"取消全选":"全选"),9,ra)])]),e("div",ca,[(n(!0),o(Y,null,G(T.value[t.slug]||{},(i,R)=>(n(),o("div",{key:R,class:K(["rule-item",{selected:B(t.slug,R),disabled:t.slug===j}]),onClick:te(U=>t.slug!==j&&y(t.slug,R),["stop"])},[e("div",da,[e("input",{type:"checkbox",checked:B(t.slug,R),onChange:te(U=>y(t.slug,R),["stop"]),disabled:t.slug===j,class:"custom-checkbox"},null,40,va),e("div",ha,[e("h5",ga,u(R),1)])]),i.content||i.metadata?(n(),o("div",pa,[O.value==="simple"&&i.metadata?(n(),o("div",fa,[i.metadata.title?(n(),o("h5",ma,u(i.metadata.title),1)):v("",!0),i.metadata.description?(n(),o("p",_a,u(i.metadata.description),1)):v("",!0),i.metadata.category||i.metadata.tags?(n(),o("div",ya,[i.metadata.category?(n(),o("span",ka,u(i.metadata.category),1)):v("",!0),i.metadata.tags&&i.metadata.tags.length>0?(n(),o("span",ba,u(i.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):(n(),o("div",Ca,[i.metadata?(n(),o("div",wa,[e("h5",null,u(i.metadata.title||R),1),i.metadata.description?(n(),o("p",Sa,u(i.metadata.description),1)):v("",!0)])):v("",!0),i.content?(n(),o("pre",$a,u(i.content.substring(0,ue))+u(i.content.length>ue?"...":""),1)):v("",!0)]))])):v("",!0)],10,ua))),128))])])):v("",!0)],10,zs))),128))])]),e("div",Ea,[a[9]||(a[9]=e("h2",null,"角色（可选）",-1)),e("div",xa,[(n(!0),o(Y,null,G(m.value,(t,i)=>{var R,U;return n(),o("div",{key:i,class:K(["item-card",{selected:((R=p.value)==null?void 0:R.name)===i}]),onClick:ee=>oe(i,t)},[e("div",Oa,[e("input",{type:"radio",name:"role",checked:((U=p.value)==null?void 0:U.name)===i,onChange:ee=>oe(i,t),class:"custom-radio"},null,40,Ia),e("div",Ta,[e("h3",Aa,u(i),1)])]),t.content||t.metadata?(n(),o("div",ja,[O.value==="simple"&&t.metadata?(n(),o("div",Ma,[t.metadata.title?(n(),o("h5",Fa,u(t.metadata.title),1)):v("",!0),t.metadata.description?(n(),o("p",Na,u(t.metadata.description),1)):v("",!0),t.metadata.traits?(n(),o("div",La,[a[8]||(a[8]=e("span",{class:"traits-label"},"特质:",-1)),e("span",Ua,u(Array.isArray(t.metadata.traits)?t.metadata.traits.join(", "):t.metadata.traits),1)])):v("",!0)])):(n(),o("div",Da,[t.metadata?(n(),o("div",Ba,[e("h5",null,u(t.metadata.title||i),1),t.metadata.description?(n(),o("p",Va,u(t.metadata.description),1)):v("",!0)])):v("",!0),t.content?(n(),o("p",Ka,u(t.content.substring(0,ue))+u(t.content.length>ue?"...":""),1)):v("",!0)]))])):v("",!0)],10,Ra)}),128))])]),e("div",Pa,[a[10]||(a[10]=e("h2",null,"命令（可选）",-1)),e("div",Ya,[(n(!0),o(Y,null,G(k.value,(t,i)=>(n(),o("div",{key:i,class:K(["item-card",{selected:b.value.some(R=>R.name===i)}]),onClick:R=>ne(i,t)},[e("div",Ha,[e("input",{type:"checkbox",checked:b.value.some(R=>R.name===i),onChange:R=>ne(i,t),class:"custom-checkbox"},null,40,qa),e("div",za,[e("h3",Wa,u(i),1)])]),t.content||t.metadata?(n(),o("div",Ja,[O.value==="simple"&&t.metadata?(n(),o("div",Qa,[t.metadata.title?(n(),o("h5",Xa,u(t.metadata.title),1)):v("",!0),t.metadata.description?(n(),o("p",Za,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.tags?(n(),o("div",eo,[t.metadata.category?(n(),o("span",to,u(t.metadata.category),1)):v("",!0),t.metadata.tags&&t.metadata.tags.length>0?(n(),o("span",so,u(t.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):(n(),o("div",ao,[t.metadata?(n(),o("div",oo,[e("h5",null,u(t.metadata.title||i),1),t.metadata.description?(n(),o("p",no,u(t.metadata.description),1)):v("",!0)])):v("",!0),t.content?(n(),o("pre",lo,u(t.content.substring(0,ue))+u(t.content.length>ue?"...":""),1)):v("",!0)]))])):v("",!0)],10,Ga))),128))])])]),e("div",io,[e("div",ro,[e("div",co,[a[11]||(a[11]=e("h2",null,"配置预览",-1)),e("div",uo,[e("div",vo,[e("button",{class:K(["mode-btn",{active:O.value==="detailed"}]),onClick:a[3]||(a[3]=t=>O.value="detailed")}," 详细 ",2),e("button",{class:K(["mode-btn",{active:O.value==="simple"}]),onClick:a[4]||(a[4]=t=>O.value="simple")}," 简洁 ",2)])])]),$.value?(n(),o("div",ho,[e("div",go,[c.value.length>0?(n(),o("div",po,[e("div",fo,[a[12]||(a[12]=e("div",{class:"card-icon"},"🤖",-1)),e("h3",null,"模式 ("+u(c.value.length)+")",1)]),e("div",mo,[(n(!0),o(Y,null,G(c.value,t=>(n(),o("div",{key:t.slug,class:"model-item"},[e("div",_o,[e("span",yo,u(t.name),1),e("span",ko,"("+u(t.slug)+")",1)]),O.value==="simple"&&t.metadata?(n(),o("div",bo,[t.metadata.description?(n(),o("p",Co,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.tags?(n(),o("div",wo,[t.metadata.category?(n(),o("span",So,u(t.metadata.category),1)):v("",!0),t.metadata.tags&&t.metadata.tags.length>0?(n(),o("span",$o,u(t.metadata.tags.join(", ")),1)):v("",!0)])):v("",!0)])):f.value[t.slug]&&f.value[t.slug].length>0?(n(),o("div",Eo,[e("span",xo,u(f.value[t.slug].length)+" rules",1)])):v("",!0)]))),128))])])):v("",!0),p.value?(n(),o("div",Ro,[a[14]||(a[14]=e("div",{class:"card-header"},[e("div",{class:"card-icon"},"🎭"),e("h3",null,"选择的角色")],-1)),e("div",Oo,[e("div",Io,[e("span",To,u(p.value.name),1),O.value==="simple"&&p.value.metadata?(n(),o("div",Ao,[p.value.metadata.description?(n(),o("p",jo,u(p.value.metadata.description),1)):v("",!0),p.value.metadata.traits?(n(),o("div",Mo,[a[13]||(a[13]=e("span",{class:"traits-label"},"特质:",-1)),e("span",Fo,u(Array.isArray(p.value.metadata.traits)?p.value.metadata.traits.join(", "):p.value.metadata.traits),1)])):v("",!0)])):v("",!0)])])])):v("",!0),b.value.length>0?(n(),o("div",No,[e("div",Lo,[a[15]||(a[15]=e("div",{class:"card-icon"},"⚡",-1)),e("h3",null,"命令 ("+u(b.value.length)+")",1)]),e("div",Uo,[e("div",Do,[(n(!0),o(Y,null,G(b.value,t=>(n(),o("div",{key:t.name,class:"command-chip"},[e("span",Bo,u(t.name),1),O.value==="simple"&&t.metadata?(n(),o("div",Vo,[t.metadata.description?(n(),o("p",Ko,u(t.metadata.description),1)):v("",!0),t.metadata.category||t.metadata.priority?(n(),o("div",Po,[t.metadata.category?(n(),o("span",Yo,u(t.metadata.category),1)):v("",!0),t.metadata.priority?(n(),o("span",{key:1,class:K(["priority-tag",t.metadata.priority])},u(t.metadata.priority),3)):v("",!0)])):v("",!0)])):v("",!0)]))),128))])])])):v("",!0)])])):v("",!0),C.value.before||C.value.after?(n(),o("div",Go,[e("div",Ho,[a[16]||(a[16]=e("div",{class:"card-icon"},"🔗",-1)),e("h3",null,"钩子 ("+u((C.value.before?1:0)+(C.value.after?1:0))+")",1)]),e("div",qo,[e("div",zo,[C.value.before?(n(),o("div",Wo,[a[17]||(a[17]=e("div",{class:"hook-name"},[e("span",{class:"name-text"},"before"),e("span",{class:"hook-type"},"前置钩子")],-1)),O.value==="simple"&&C.value.before.metadata?(n(),o("div",Jo,[C.value.before.metadata.title?(n(),o("p",Qo,u(C.value.before.metadata.title),1)):v("",!0),C.value.before.metadata.description?(n(),o("p",Xo,u(C.value.before.metadata.description),1)):v("",!0),C.value.before.metadata.category?(n(),o("div",Zo,[e("span",en,u(C.value.before.metadata.category),1)])):v("",!0)])):v("",!0)])):v("",!0),C.value.after?(n(),o("div",tn,[a[18]||(a[18]=e("div",{class:"hook-name"},[e("span",{class:"name-text"},"after"),e("span",{class:"hook-type"},"后置钩子")],-1)),O.value==="simple"&&C.value.after.metadata?(n(),o("div",sn,[C.value.after.metadata.title?(n(),o("p",an,u(C.value.after.metadata.title),1)):v("",!0),C.value.after.metadata.description?(n(),o("p",on,u(C.value.after.metadata.description),1)):v("",!0),C.value.after.metadata.category?(n(),o("div",nn,[e("span",ln,u(C.value.after.metadata.category),1)])):v("",!0)])):v("",!0)])):v("",!0)])])])):(n(),o("div",rn,[...a[19]||(a[19]=[e("div",{class:"empty-icon"},"📋",-1),e("p",null,"请选择配置项以查看预览",-1)])]))]),e("div",cn,[e("button",{class:"btn btn-primary",disabled:!D.value,onClick:z},[...a[20]||(a[20]=[e("span",{class:"btn-icon"},"📥",-1),se(" 导出配置 ",-1)])],8,un),e("button",{class:"btn btn-secondary",onClick:le},[...a[21]||(a[21]=[e("span",{class:"btn-icon"},"💾",-1),se(" 保存配置 ",-1)])]),e("button",{class:"btn btn-secondary",onClick:E},[...a[22]||(a[22]=[e("span",{class:"btn-icon"},"🔄",-1),se(" 重置选择 ",-1)])])])])])]),we(Ds,{show:M.value,"onUpdate:show":a[5]||(a[5]=t=>M.value=t),onSave:fe,onLoad:h},null,8,["show"])]))}});const fn=Ee(vn,[["__scopeId","data-v-4041200e"]]);export{fn as default};
