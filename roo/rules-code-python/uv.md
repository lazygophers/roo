# uvï¼šä¸‹ä¸€ä»£ Python åŒ…ç®¡ç†å·¥å…·

> `uv` æ˜¯ä¸€ä¸ªç”¨ Rust ç¼–å†™çš„ã€é€Ÿåº¦æå¿«çš„ Python åŒ…è§£æå™¨ã€å®‰è£…å™¨ã€ç¼–è¯‘å™¨å’Œè§£æå™¨ã€‚å®ƒæ—¨åœ¨æˆä¸º `pip`ã€`pip-tools` å’Œ `virtualenv` çš„ç›´æ¥æ›¿ä»£å“ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€ã€é«˜æ•ˆçš„å·¥å…·é“¾ã€‚

---

## æ ¸å¿ƒç‰¹æ€§

- **âš¡ï¸ æè‡´æ€§èƒ½**: `uv` çš„é€Ÿåº¦éå¸¸å¿«ï¼Œåœ¨å®‰è£…å’Œè§£æä¾èµ–æ—¶ï¼Œé€šå¸¸æ¯” `pip` å’Œ `pip-tools` å¿« **10-100 å€**ã€‚
- **ğŸ“¦ ä¸€ä½“åŒ–å·¥å…·é“¾**: å•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ `uv` å³å¯å¤„ç†è™šæ‹Ÿç¯å¢ƒåˆ›å»ºã€ä¾èµ–å®‰è£…ã€é”å®šå’ŒåŒæ­¥ç­‰æ‰€æœ‰å¸¸è§ä»»åŠ¡ã€‚
- **ğŸ¤ `pip` å…¼å®¹**: `uv` æä¾›äº† `uv pip` å­å‘½ä»¤ï¼Œä¸ `pip` çš„ API å®Œå…¨å…¼å®¹ï¼Œå¯ä»¥æ— ç¼é›†æˆåˆ°ç°æœ‰é¡¹ç›®ä¸­ã€‚
- ** caching**: å†…ç½®å…¨å±€ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤ä¸‹è½½åŒ…ï¼Œè¿›ä¸€æ­¥æå‡å®‰è£…é€Ÿåº¦ã€‚
- **ğŸ¦€ Rust æ„å»º**: åŸºäº Rust çš„é«˜æ€§èƒ½å’Œå†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œä¿è¯äº†å·¥å…·çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚

---

## ğŸš€ æ ¸å¿ƒå·¥ä½œæµï¼šä»é›¶åˆ°ä¸€

æœ¬èŠ‚å°†å¼•å¯¼ä½ å®Œæˆ `uv` æœ€æ¨èçš„ç°ä»£åŒ–å·¥ä½œæµï¼Œè¯¥å·¥ä½œæµä»¥ `pyproject.toml` ä¸ºæ ¸å¿ƒï¼Œå®ç°å£°æ˜å¼çš„ä¾èµ–ç®¡ç†ã€‚

### 1. ä»€ä¹ˆæ˜¯è™šæ‹Ÿç¯å¢ƒï¼Ÿ

> **è™šæ‹Ÿç¯å¢ƒ**æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Python è¿è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸ä½ ä¸ºæ¯ä¸ªé¡¹ç›®å®‰è£…ä¸åŒç‰ˆæœ¬çš„åŒ…ï¼Œè€Œä¸ä¼šç›¸äº’å¹²æ‰°ã€‚è¿™æ˜¯ Python å¼€å‘çš„æœ€ä½³å®è·µã€‚

ä½¿ç”¨ `uv` åˆ›å»ºå’Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒéå¸¸ç®€å•ï¼š

```bash
# åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º .venv çš„è™šæ‹Ÿç¯å¢ƒ
uv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (åªéœ€æ‰§è¡Œä¸€æ¬¡)
# macOS / Linux
source .venv/bin/activate

# Windows
.venv\Scripts\activate
```

### 2. ä»€ä¹ˆæ˜¯ä¾èµ–ç®¡ç†ï¼Ÿ

> **ä¾èµ–ç®¡ç†**æ˜¯æŒ‡å£°æ˜ã€å®‰è£…å’Œç»´æŠ¤é¡¹ç›®æ‰€éœ€å¤–éƒ¨åº“ï¼ˆåŒ…ï¼‰çš„è¿‡ç¨‹ã€‚`uv` æ¨èä½¿ç”¨ `pyproject.toml` æ–‡ä»¶æ¥é›†ä¸­ç®¡ç†è¿™äº›ä¾èµ–ã€‚

ä½¿ç”¨ `uv add` å‘½ä»¤å¯ä»¥è½»æ¾åœ°å‘ `pyproject.toml` æ·»åŠ å¹¶å®‰è£…ä¾èµ–ï¼š

```bash
# æ›´æ–°è™šæ‹Ÿç¯å¢ƒ
uv sync

# æ·»åŠ ä¸€ä¸ªç”Ÿäº§ä¾èµ– (ä¾‹å¦‚ï¼šfastapi)
# uv ä¼šè‡ªåŠ¨æ›´æ–° pyproject.toml å¹¶å°†å…¶å®‰è£…åˆ° .venv
uv add fastapi

# æ·»åŠ ä¸€ä¸ªä»…åœ¨å¼€å‘æ—¶ä½¿ç”¨çš„ä¾èµ– (ä¾‹å¦‚ï¼špytest)
uv add pytest --dev

# ç§»é™¤ä¸€ä¸ªä¾èµ–
uv remove fastapi
```

**`pyproject.toml` ç¤ºä¾‹ï¼š**

`uv add` å‘½ä»¤ä¼šè‡ªåŠ¨ç»´æŠ¤ `[project.dependencies]` å’Œ `[project.optional-dependencies.dev]` è¿™ä¸¤ä¸ªéƒ¨åˆ†ã€‚

```toml
[project]
name = "my-awesome-project"
version = "0.1.0"
dependencies = [
    "fastapi",
]

[project.optional-dependencies]
dev = [
    "pytest",
]
```

### 3. å¦‚ä½•åœ¨ç¯å¢ƒä¸­æ‰§è¡Œå‘½ä»¤ï¼Ÿ

> **å·¥ä½œæµ**æ˜¯æŒ‡åœ¨è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œä»£ç ã€è¿è¡Œæµ‹è¯•ç­‰ä¸€ç³»åˆ—æ“ä½œã€‚`uv run` å¯ä»¥åœ¨ä¸æ‰‹åŠ¨æ¿€æ´»ç¯å¢ƒçš„æƒ…å†µä¸‹ï¼Œç›´æ¥åœ¨è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œå‘½ä»¤ã€‚

```bash
# åœ¨ .venv ç¯å¢ƒä¸­è¿è¡Œä¸€ä¸ª Python è„šæœ¬
uv run python my_script.py

# åœ¨ .venv ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•
uv run pytest
```

---

## ğŸ› ï¸ é«˜çº§åº”ç”¨ä¸ Pip å…¼å®¹æ€§

`uv` å®Œå…¨å…¼å®¹ä¼ ç»Ÿçš„ `requirements.txt` å·¥ä½œæµï¼Œå¹¶æä¾›äº†ä¸€äº›å¼ºå¤§çš„é«˜çº§åŠŸèƒ½ã€‚

### ä¾èµ–é”å®šä¸åŒæ­¥

- **ç¼–è¯‘ (Compile)**: å°† `pyproject.toml` æˆ– `requirements.in` ä¸­çš„é«˜çº§ä¾èµ–è§£æä¸ºå…·ä½“çš„ã€å¯å¤ç°çš„ `requirements.txt` æ–‡ä»¶ã€‚

  ```bash
  # ä» pyproject.toml ç”Ÿæˆ requirements.txt
  uv pip compile pyproject.toml -o requirements.txt
  ```

- **åŒæ­¥ (Sync)**: ç¡®ä¿å½“å‰è™šæ‹Ÿç¯å¢ƒä¸­çš„åŒ…ä¸ `requirements.txt` æ–‡ä»¶**å®Œå…¨ä¸€è‡´**ï¼Œä¸å¤šä¸å°‘ã€‚

  ```bash
  # æ ¹æ® requirements.txt åŒæ­¥ç¯å¢ƒ
  uv pip sync requirements.txt
  ```

### ç¼“å­˜ç®¡ç†

`uv` ä½¿ç”¨å…¨å±€ç¼“å­˜æ¥åŠ é€Ÿé‡å¤å®‰è£…ã€‚

```bash
# æ¸…ç†ä¸å†ä½¿ç”¨çš„ç¼“å­˜æ¡ç›®
uv cache clean
```

### ä¸ Pip çš„å·¥ä½œæµå¯¹æ¯”

ä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº† `uv` çš„ç°ä»£åŒ–å·¥ä½œæµä¸ä¼ ç»Ÿ `pip` å·¥ä½œæµçš„å‘½ä»¤å·®å¼‚ã€‚

| ä»»åŠ¡åœºæ™¯          | âœ… `uv` ç°ä»£åŒ–å·¥ä½œæµ (`pyproject.toml`)     | å…¼å®¹ `pip` çš„å·¥ä½œæµ (`requirements.txt`)   |
| :---------------- | :------------------------------------------ | :----------------------------------------- |
| **åˆ›å»ºç¯å¢ƒ**      | `uv venv`                                   | `python -m venv .venv`                     |
| **å®‰è£…/æ·»åŠ ä¾èµ–** | `uv add <pkg>`                              | `uv pip install <pkg>`                     |
| **ä»æ–‡ä»¶å®‰è£…**    | `uv pip sync requirements.txt`              | `uv pip install -r requirements.txt`       |
| **é”å®šä¾èµ–**      | `uv pip compile pyproject.toml -o reqs.txt` | `uv pip freeze > requirements.txt`         |
| **æ‰§è¡Œå‘½ä»¤**      | `uv run <cmd>`                              | `source .venv/bin/activate` åæ‰§è¡Œ `<cmd>` |
