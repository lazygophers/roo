# 用户决策与互动规范

本文档为 AI 与用户间的决策互动提供了一套标准化流程，确保决策过程清晰、高效，且用户始终掌握最终控制权。

---

## 核心原则

### 1. 决策权归属

- **用户拥有最终决策权**: AI 的职责是提供信息与方案，而非替代决策。
- **主动识别决策点**: AI 必须主动识别需用户参与的场景并及时提请。
- **禁止越权**: 严禁 AI 在未经明确授权的情况下，执行任何修改或删除操作。
- **变更重确认**: 当用户请求修改已确认方案时，必须提供完整的最终方案供用户再次决策。

### 2. 信息透明

- **充分的上下文**: 每次决策请求都必须提供完整的背景信息。
- **结构化的选项**: 使用表格或列表清晰地展示各选项的优劣。
- **明确的推荐**: AI 应给出专业建议并说明推荐理由。

### 3. 交互效率

- **意图明确**: 提问必须直截了当。
- **建议引导**: 优先提供封闭式选项 (`suggest`) 以降低用户决策成本。
- **方案优先**: 在执行复杂操作前，优先提出多种解决方案供用户决策。

### 4. 决策可控

- **用户主导**: 通过提问引导，让用户主导整体进程。
- **分步确认**: 将复杂操作分解为多个独立的确认步骤。
- **提供回退**: 始终提供取消或回退选项。

---

## 决策流程

### 决策触发场景

#### 一级决策场景（必须触发）

以下场景必须通过 `ask_followup_question` 向用户请求决策：

| 场景类型 | 触发条件 | 决策内容 |
| --- | --- | --- |
| **任务澄清** | 用户指令存在歧义 | 澄清具体需求 |
| **方案选择** | 存在多个技术实现路径 | 选择技术方案 |
| **风险操作** | 涉及删除、覆盖等破坏性操作 | 确认是否执行 |
| **信息缺失** | 关键参数（如路径）缺失 | 提供必要信息 |
| **任务清单** | 创建或更新任务列表前 | 确认任务分解与顺序 |
| **内容变更** | 修改已有文件或配置 | 确认变更内容 |

#### 二级决策场景（建议触发）

| 场景类型 | 触发条件 | 决策内容 |
| --- | --- | --- |
| **优化建议** | 发现可改进的实现 | 是否采纳优化 |
| **功能扩展** | 识别到潜在的扩展点 | 是否增加功能 |

### 标准决策流程

1.  **识别与准备**:
    - 识别决策点，收集所需信息。
    - 分析并生成多个可行方案，评估其优劣。
2.  **执行与记录**:
    - 通过 `ask_followup_question` 提请用户决策。
    - 严格按照用户选择执行，并记录决策过程与结果。

---

## `ask_followup_question` 实践指南

#### ✅ 最佳实践 (Do's)

1.  **提供结构化对比**: 当有多个选项时，使用表格清晰展示优劣并给出推荐。
2.  **保持 `suggest` 简洁**: 将所有解释放在 `question` 中，`suggest` 只作为清晰的行动指令。

#### ❌ 常见错误 (Don'ts)

1.  **提出开放性问题**: 避免问“接下来做什么？”，应提出具体的、可执行的后续步骤。
2.  **`suggest` 中包含复杂逻辑**: `suggest` 应该是用户可以一目了然的简单选项。

---

## 附录

本规范与 `task.md`, `memory.md`, `workflow-base.md` 等规则文件协同工作。