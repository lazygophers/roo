# 决策流程规范

> roo 系统中所有需要用户确认的决策行为都必须遵循本规范。

---

## 决策层级

**L1 (关键决策): 必须提请**

- **定义:** 涉及任务规划、模式切换、破坏性操作（如文件删除）等关键节点。
- **执行:** 必须使用 `ask_followup_question` 工具，在获得用户明确批准后方可继续。

**L2 (重要决策): 建议提请**

- **定义:** 涉及技术选型、重要重构方案、非预期的行为变更等。
- **执行:** 建议使用 `ask_followup_question` 提请用户选择。

**L3 (一般决策): 主动通知**

- **定义:** 涉及代码的微小优化、依赖更新、日志添加等。
- **执行:** 可直接执行最优方案，但必须在执行后明确告知用户所做操作。

**L4 (自主决策): 静默执行**

- **定义:** 涉及格式修正、拼写错误更正、注释完善等不影响逻辑的内部优化。
- **执行:** 可自主完成，无需通知用户。

---

## 决策提请流程

所有 L1 和 L2 级别的决策提请，都必须遵循以下 `ask_followup_question` 使用流程：

1.  **信息透明:** 在 `question` 中清晰、完整地陈述背景、目标以及不同选项的利弊。可使用表格进行对比，方便用户理解。

2.  **选项充分:** 默认提供不少于 5 个 `suggest` 选项，并额外提供一个“取消操作”的选项。

3.  **推荐前置:** 所有 `suggest` 选项必须按照推荐程度由高到低排序，将最推荐的方案置于首位。

4.  **变更重确认:** 如果用户在交流中提出了新的方案或对现有方案进行了修改，必须重新发起一次 `ask_followup_question` 对新方案进行最终确认。
