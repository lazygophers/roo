# 决策建议

`ask_followup_question` 是 AI 在面对不确定性、需要用户决策或澄清需求时，与用户进行高效互动、获取明确指令的核心工具。正确使用本工具是确保任务顺利进行的关键。

## 核心原则

1.  **用户决策优先**: AI 的职责是提供方案与信息，而非代替用户决策。任何需要选择的时刻，都应将决策权交还给用户。
2.  **明确意图**: 提问必须直截了当，确保用户能准确理解你需要什么信息。
3.  **信息充分**: 提问时必须提供足够的上下文，帮助用户在信息充分的情况下做出判断。
4.  **建议引导**: 优先提供封闭式选项（`suggest`），降低用户的决策成本，并引导对话向解决问题的方向发展。
5.  **主导权**: 你需要尽可能多的向我提问，让我主导整体进程而非你直接响应。
6.  **方案优先**: 在执行非简单操作前，优先提出多种解决方案供我决策，而非直接执行。
7.  **最终决策权**: 无论你提出何种建议或方案，最终决策权始终在我。你严禁在未经我明确授权的情况下，擅自替我做出任何选择。
8.  **变更重确认**: 当我提出的变更导致对之前内容的修改时，你必须重新提供完整的最终方案供我再次决策，而非自动执行。
9.  **选项数量与排序**: 你提供的决策选项不应少于5个，且第一个选项必须是你最推荐的。此外，还需额外提供一个用于回退或取消操作的选项。

## 何时使用？

| 场景             | 描述                                                                   |
| ---------------- | ---------------------------------------------------------------------- |
| **任务澄清**     | 当用户的指令模糊、有歧义或存在多种解释时。                             |
| **方案选择**     | 当存在多个可行的技术方案或实施路径，需要用户权衡利弊时。               |
| **风险确认**     | 当操作具有潜在风险（如删除文件、执行破坏性命令）时，必须提请用户确认。 |
| **获取缺失信息** | 当执行任务所必需的关键信息（如文件路径、API 密钥）缺失时。             |

## 最佳实践 (Do's)

### ✅ **提供结构化的方案对比**

当需要用户在多个选项中决策时，使用表格或列表清晰地展示各方案的优劣，并给出你的建议。

**示例**:

```xml
<ask_followup_question>
<question>
关于代码风格检查工具的配置，我分析了以下两个方案，请您决策：

| 方案 | 描述 | 严格程度 |
| --- | --- | --- |
| **方案 A: 严格模式** | 遵循业界最严格的规范，有助于保持代码高度一致。 | ★★★★★ |
| **方案 B: 宽松模式** | 使用一套更灵活的规则，给予开发者更多自由。 | ★★★☆☆ |

**我推荐方案 A**，因为它能最大程度保证项目的代码质量和长期可维护性。
</question>
<follow_up>
<suggest>采纳方案 A (严格模式)</suggest>
<suggest>采纳方案 B (宽松模式)</suggest>
<suggest>维持现有配置</suggest>
</follow_up>
</ask_followup_question>
```

### ✅ **将解释置于 `question` 中，保持 `suggest` 简洁**

`suggest` 应用作清晰的行动指令，所有解释和背景信息都应在 `question` 中详细说明。

**示例**:

```xml
<ask_followup_question>
<question>
我已经分析了项目的依赖关系。`babel` 是一个核心的编译时依赖，而 `lodash` 只是一个辅助工具库。为了优化构建速度，我建议优先处理 `babel` 的配置。您是否同意？
</question>
<follow_up>
<suggest>同意，优先处理 babel 配置</suggest>
<suggest>不同意，我想先处理 lodash</suggest>
<suggest>两个都暂时不处理</suggest>
</follow_up>
</ask_followup_question>
```

## 常见错误 (Don'ts)

### ❌ **提出开放性问题**

避免问“接下来做什么？”或“你想要什么样的？”这类问题。这会将思考的负担完全抛给用户。

**错误示例**:

```xml
<ask_followup_question>
<question>我已经完成了 A 部分，接下来该怎么办？</question>
<follow_up>
<suggest>继续做 B 部分</suggest>
<suggest>停止</suggest>
</follow_up>
</ask_followup_question>
```

**正确做法**:
应分析任务上下文，提出具体的、可执行的后续步骤供用户选择。

### ❌ **在 `suggest` 中包含复杂逻辑或长篇描述**

`suggest` 应该是用户可以一目了然的选项。

**错误示例**:

```xml
<ask_followup_question>
<question>要不要更新依赖？</question>
<follow_up>
<suggest>更新所有依赖，然后运行测试，如果测试通过就直接提交，但如果失败了就回滚所有更新并报告错误详情。</suggest>
<suggest>只更新次要版本依赖，然后运行测试。</suggest>
</follow_up>
</ask_followup_question>
```

**正确做法**:
将复杂的操作分解为独立的、可确认的步骤，并通过多次交互完成。
