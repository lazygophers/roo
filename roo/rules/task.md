# 任务管理指南

> roo 系统任务分解、评估与执行的核心规范。

---

## 任务复杂度评估

### 五维评估模型

| 维度           | 权重 | Simple (0-30) | Medium (31-70)        | Complex (71-100)      |
| -------------- | ---- | ------------- | --------------------- | --------------------- |
| **技术复杂度** | 25%  | 单一技术栈    | 多技术栈组合/架构改动 | 新技术探索/突破性创新 |
| **规模复杂度** | 20%  | 1-10 个文件   | 11-30 个文件          | >30 个文件            |
| **依赖复杂度** | 20%  | 0-2 个依赖    | 3-5 个依赖            | >5 个依赖             |
| **认知复杂度** | 20%  | 需求清晰      | 需要分析设计          | 需要创新/高度抽象     |
| **执行复杂度** | 15%  | <4 小时       | 1-2 天                | >3 天                 |

**评分公式**：总分 = Σ(维度得分 × 权重)

### 执行策略映射

| 等级        | 分值   | 策略                         | 场景                 |
| ----------- | ------ | ---------------------------- | -------------------- |
| **Simple**  | 0-30   | 任务清单+直接执行            | 配置修改、简单修复   |
| **Medium**  | 31-70  | 任务清单+模式切换            | 新功能、部分重构     |
| **Complex** | 71-100 | 任务清单+深度规划+多模式协作 | 架构设计、大规模重构 |

---

## 任务分解核心原则

### 三维原则框架

| 维度         | 原则       | 说明               |
| ------------ | ---------- | ------------------ |
| **执行维度** | 操作原子性 | 不可再分的最小单元 |
|              | 事务完整性 | 满足 ACID 特性     |
|              | 单一职责   | 一个任务一个目标   |
| **控制维度** | 粒度控制   | 5 分钟-2 小时为宜  |
|              | 并行能力   | 最大化并行执行     |
|              | 规模灵活性 | 支持弹性伸缩       |
| **保障维度** | 失败隔离   | 故障不扩散         |
|              | 独立验证   | 可独立测试验收     |
|              | 进度追踪   | 实时可见可量化     |

---

## 任务调度与分解

### 通用行为准则

- **清单确认:** 任务清单的创建和更新属于 **L1 级关键决策**，必须遵循决策流程规范进行确认。
- **分析与拆解:** 接到任务时以最高优先级进行任务分析、拆解。
- **子任务创建:**
  - 非 `orchestrator` 模式下接收复杂任务时，通过 `new_task` 创建 orchestrator 子任务进行分解
  - 需要切换模式时，通过 `new_task` 创建新的子任务
- **常用分解策略:**
  - Git 操作作为同一个子任务
  - 文件批量操作时每个文件作为独立子任务
  - 测试用例生成时每个函数对应独立子任务
  - 批量执行时每个操作对象作为独立子任务

### new_task 工具使用指南

#### 核心参数

- **`mode`**: 指定执行模式
- **`message`**: 结构化的任务指令（JSON格式），包含：
  - `objective`: 任务目标
  - `context`: 执行上下文
  - `deliverables`: 交付要求
  - `scope`: 任务边界
  - `acceptance_criteria`: 完成标准

#### 拆分原则

- **不可再分**: 确保每个子任务都是最小的独立工作单元
- **交付独立**: 确保子任务的产出可以独立交付
- **验证独立**: 确保子任务的正确性可以独立验证
- **逻辑独立**: 确保子任务的业务逻辑自包含

---

## 模式选择策略

### 核心模式职责

- **`architect`**: 系统架构设计、技术选型、重构规划
- **`orchestrator`**: 任务分解、复杂决策、多步骤规划
- **`code`**: 通用代码开发、功能实现、调试
- **`code-*`**: 特定语言/框架的专业开发
- **`debug`**: Bug追踪、错误诊断、问题解决
- **`doc-writer`**: 文档创建、更新、改进
- **`giter`**: 版本控制操作
- **`memory`**: 记忆库初始化、清理
- **`project-research`**: 代码库分析、技术调研
- **`researcher`**: 知识整理、方案分析

---

## 任务模板库

### 模板框架

任务模板包含以下核心要素：

- **基本信息**: ID、名称、适用场景、复杂度
- **前置条件**: 必须满足的先决条件
- **分解结构**: 阶段划分、任务列表、依赖关系
- **验证标准**: 完成标准、质量要求

### 模板定制维度

| 定制项       | 说明                     |
| ------------ | ------------------------ |
| **规模调整** | 根据项目规模增减子任务   |
| **技术适配** | 替换为实际使用的技术栈   |
| **时间压缩** | 并行化可独立执行的任务   |
| **质量权衡** | 根据质量要求调整验证深度 |