---
name: task
title: 任务管理指南
description: "定义AI系统任务分解、评估与执行的核心规范，包含任务管理哲学、模式协作机制和工作流程"
category: rule
priority: critical
tags: [任务管理, 模式协作, 工作流程]
sections:
  - "核心理念：任务管理哲学和原则"
  - "任务评估：分解原则和评估标准"
  - "模式选择：专业分工和协作机制"
  - "工作流：最佳实践和性能优化"
  - "new_task委派规范：消息格式和字段定义"
---

# 任务管理指南

> AI 系统任务分解、评估与执行的核心规范。

---

## 核心理念

**任务管理哲学**

- **简洁明了:** 所有描述、要求和交付物都应简洁清晰，避免冗余信息。
- **精准匹配:** 仅提供与任务直接相关的上下文，确保信息高度聚焦。
- **模式驱动:** 基于任务性质智能选择最适合的专业模式。
- **价值导向:** 每个任务都应明确其价值点和预期产出。

---

## 任务评估与分解

**任务分解原则**

- **单一职责:** 每个子任务只做一件事。
- **原子性:** 任务应是不可再分的最小执行单元。
- **独立验证:** 子任务的结果应能被独立测试和验收。
- **简洁性:** 任务描述和要求必须简洁明了，避免歧义。

---

## 任务调度与模式选择

**通用准则**

- **规划先行:** 任何复杂任务在执行前，都必须由 `orchestrator` 模式进行分解，并通过 `ask_followup_question` 提请用户确认任务清单。
- **专业分工:** 根据任务性质，通过 `new_task` 委派给最合适的专业模式。

---

## 通用工作流与最佳实践

### 任务与交互原则

1. **模式切换**: 禁止使用 `switch_mode` 进行模式切换，所有模式间的转换与任务委派，都必须通过 `new_task` 完成。
2. **任务粒度**: 在非 `orchestrator` 模式下执行任务时，必须将任务分解得尽可能细致，确保每个步骤都是一个原子操作。
3. **决策确认**: 必须通过 `ask_followup_question` 向用户提请对最终任务清单的确认。如果用户提出变更，在应用变更后，必须重新发起确认流程。
4. **信息呈现**: 在使用 `ask_followup_question` 进行确认时，必须综合运用流程图、清单、表格等多种可视化方式，向用户清晰、详尽地展示待确认的内容。
5. **模式专业化**: 严格遵循专业分工原则，确保每个模式只处理其擅长的领域，超出能力范围的任务必须通过 `new_task` 委派。
6. **上下文精简**: 在任务委派和执行过程中，仅传递与任务直接相关的上下文信息，避免信息过载。

### 核心原则

1. **分层决策**: L1 级决策必须请求用户确认
2. **批量优化**: 合并多个修改到单个 `apply_diff`
3. **验证先行**: 修改前用 `list_files` 确认文件存在
4. **及时更新**: 每个关键节点更新 `update_todo_list`

### 性能优化

- **批量操作**:
  - 单个 `apply_diff` 处理多个修改
  - 合并多个 `read_file` 请求（最多 5 个）
